<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>Go的new和make区别&nbsp;|&nbsp;Notablog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="Go的new和make区别">
  
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>关于我</span>
        </div>
      </a>
    
  
    
  
    
  
    
  
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
    <h1 class="Header__Title">Go的new和make区别</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Mon, Nov 21, 2022</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--pink">
            <a href="tag/Go.html">Go</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/b8c49e9f7caf4690944af641435b9a82" class="PageRoot"><ul id="https://www.notion.so/31bf3cf246d148828e6fc42a883dccbb" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/f4da705005b34e3faa0a1107f364d1ad"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">简介</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ac558594f82846068fb1153404e14d1e"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">make</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8f2886cbed2446febc748d9865381a24"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">new</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/944bc03233cb456884ad4a81b7bbd092"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">扩展</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8bc888b1202c4c438d7e6ed829ab94f6"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">指针比较原则</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8b48a59bc4cc427eab612ca63bcb51fd"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">传引用？还是传值？</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/36089ade6f7e4952833e808c14ec02e9"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">Ref</span></span></div></a></li></ul><h1 id="https://www.notion.so/f4da705005b34e3faa0a1107f364d1ad" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/f4da705005b34e3faa0a1107f364d1ad"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">简介</span></span></h1><div id="https://www.notion.so/34c91992185b4a74af33dacbd79d7560" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">先上结论</span></span></p></div><div id="https://www.notion.so/3b07325b47334731b12af4e56a8e927c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new(T)</code></span><span class="SemanticString">返回T类型的指针，指向T类型的零值</span></span></p></div><div id="https://www.notion.so/1fd6c4e797ef4ef2abefc5d95daf868d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">make(T)</code></span><span class="SemanticString">返回初始化后的T的引用，只能用于</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice、map、channel</code></span></span></p></div><div id="https://www.notion.so/aec0898556454aaa82985b8409420286" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在Go里面，你几乎很少会遇到必须使用new的场景</span></span></p></div><h1 id="https://www.notion.so/ac558594f82846068fb1153404e14d1e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/ac558594f82846068fb1153404e14d1e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">make</span></span></h1><div id="https://www.notion.so/6d022a0338364c3bb593f4c100b2dbea" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">make用来初始化</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice、map、channel</code></span><span class="SemanticString">，并返回这些结构的引用</span></span></p></div><div id="https://www.notion.so/cc1570b6b9144d628e7250b13657d643" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果我们使用</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">var</code></span><span class="SemanticString"> 来声明一个结构体，将会是nil值，对nil值操作可能会引起panic，只有赋值之后才能使用，下面我们看看这个测试用例</span></span></p></div><pre id="https://www.notion.so/60639a0ac4a141c9851f6181b7df59f3" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>func TestMake(t *testing.T) {
	var m1 map[int]string
	fmt.Printf(&quot;%#v\n&quot;, m1)

	m2 := make(map[int]string)
	fmt.Printf(&quot;%#v\n&quot;, m2)

	var c1 chan string
	fmt.Printf(&quot;%#v\n&quot;, c1)

	c2 := make(chan string)
	fmt.Printf(&quot;%#v\n&quot;, c2)
}</span></span></span></code></pre><div id="https://www.notion.so/e2a4a4800d5947d5a848da64aa55dd10" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">输出结果：</span></span></p></div><pre id="https://www.notion.so/eceb1f13406a4102b534e92c5568e36a" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>map[int]string(nil)
map[int]string{}
(chan string)(nil)
(chan string)(0x140000c0240)</span></span></span></code></pre><div id="https://www.notion.so/420aced227a64eb580a88e072eb24f0c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">可以看到确实是符合我们上面的分析</span></span></p></div><h1 id="https://www.notion.so/8f2886cbed2446febc748d9865381a24" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/8f2886cbed2446febc748d9865381a24"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">new</span></span></h1><div id="https://www.notion.so/b56f013f107f49d48a4cfeae4f582b60" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new(T)</code></span><span class="SemanticString"> 适用的T范围更广，它返回T类型的指针，指向T类型的零值</span></span></p></div><div id="https://www.notion.so/408f126d7f5841bf93191463a2cf3194" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">比如说这个例子：</span></span></p></div><pre id="https://www.notion.so/88d5c91a41804d5eaae7b377867be04c" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>func TestNew(t *testing.T) {
	var p1 *int
	a := 1
	// fmt.Println(*p1) p1 is nil, panic
	p1 = &amp;a
	fmt.Println(*p1)

	p2 := new(int)
	fmt.Println(*p2)
	p2 = &amp;a
	fmt.Println(*p2)
}</span></span></span></code></pre><div id="https://www.notion.so/40207f40292142d2b0aac485c3b2f35b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">输出：</span></span></p></div><pre id="https://www.notion.so/f196c7cd6e444cdfbcbec8b9fc2818d9" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>1
0
1</span></span></span></code></pre><div id="https://www.notion.so/56b65e2a92f3416c9bb48ccebc83b409" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">我们可以通过这个例子看到</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">var</code></span><span class="SemanticString"> 和</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString"> 的区别，</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">var</code></span><span class="SemanticString">一个指针此时是nil的，未经赋值直接使用会panic，而</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString">就不会有这种问题出现</span></span></p></div><div id="https://www.notion.so/2512e98657f14455b6f05967fde2d8e2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">实际上我们很少会用到</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString"> 因为它总是可以被其它操作替代</span></span></p></div><pre id="https://www.notion.so/d0e2a798fc2149eeb785efb876337ac4" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>func TestNew2(t *testing.T) {
	var car1 *Car
	InnerCar := Car{}
	car1 = &amp;InnerCar

	var car2 *Car = new(Car)

	car3 := &amp;Car{} // 最简洁的方式

	car4 := new(Car)

	fmt.Println(car1.id)
	fmt.Println(car2.id)
	fmt.Println(car3.id)
	fmt.Println(car4.id)
}</span></span></span></code></pre><div id="https://www.notion.so/3dee9f2d8c4c4cc7a78118181a0c1b9f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">输出结果：</span></span></p></div><pre id="https://www.notion.so/6b3d6487c90247dbb4a36371b43eba97" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>0
0
0
0</span></span></span></code></pre><div id="https://www.notion.so/64ac199e94f14512963807029d376284" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">你可以看到上面四种Car都是指针，它们输出结果都是一致的，其中</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&amp;Car</code></span><span class="SemanticString">是最简洁的声明方式了</span></span></p></div><div id="https://www.notion.so/6f15dd8ce0dc47b5a023d24322889986" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">C/C++语言的选手可能会感到疑惑，为什么不用</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">(&amp;Car3).id</code></span><span class="SemanticString"> 也能拿到</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">id</code></span><span class="SemanticString">的值呢？</span></span></p></div><div id="https://www.notion.so/280eda975c5c4238a1a46f98e33f0505" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这是因为Go从语言层面做了优化：</span></span></p></div><blockquote id="https://www.notion.so/20d07bf6f946418f9e2a4d0d4b6b8a5b" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString">如果x是指针，&amp;x里面属性集合包含了m，那么x.m和(&amp;x).m是等价的，Go会自动转换</span></span></blockquote><div id="https://www.notion.so/2227a21e55de493889e1e4b74349e406" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h1 id="https://www.notion.so/944bc03233cb456884ad4a81b7bbd092" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/944bc03233cb456884ad4a81b7bbd092"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">扩展</span></span></h1><div id="https://www.notion.so/3daf421af56246ce809f5ed4fd12ff39" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">既然提到了指针，我们来聊聊指针相关的东西吧</span></span></p></div><h2 id="https://www.notion.so/8bc888b1202c4c438d7e6ed829ab94f6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8bc888b1202c4c438d7e6ed829ab94f6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">指针比较原则</span></span></h2><div id="https://www.notion.so/86dc03158a1644dc8075dde19c7ca2d9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Go定义了指针比较原则：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/0d1561e60eba44b78f3e1a1275063537" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">只有同类型的指针才能比较</span></span></li></ul><div id="https://www.notion.so/e64c1f89fe8846b7a32ef9cabb2fa3dd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果你在1.18之前尝试对不同类型的指针比较，就会报错，提示你：</span></span></p></div><pre id="https://www.notion.so/db50d02abb1040249b0f644f1a3cfd8d" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>./slice_test.go:120:17: invalid operation: p4 == p5 (mismatched types *int and *string)
note: module requires Go 1.18</span></span></span></code></pre><ul class="BulletedListWrapper"><li id="https://www.notion.so/9341d3261ab0411ea3ea39fd300b1e8b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">指针指向同一个对象，或者都是nil的时候比较结果是</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">true</code></span></span></li><li id="https://www.notion.so/e70400a83f4c4d10b64d567a921b5e16" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">否则比较结果都是</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">false</code></span></span></li></ul><div id="https://www.notion.so/ba63d6bf0e6542499ef6c89246e1bae1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">比如这个例子</span></span></p></div><pre id="https://www.notion.so/cffc38ff3a2c4e80b5e959be90e21589" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>func TestNil(t *testing.T) {
	var p1 *int
	var p2 *int
	a := 1
	p3 := new(int)
	p3 = &amp;a
	p4 := &amp;a

	fmt.Println(p1 == p2) // true, p1 and p2 is nil
	fmt.Println(p2 == p3) // false, p2 is nil, p3 non-nil 
	fmt.Println(p4 == p3) // true, p3 and p4 指向同一个对象
}</span></span></span></code></pre><h2 id="https://www.notion.so/8b48a59bc4cc427eab612ca63bcb51fd" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8b48a59bc4cc427eab612ca63bcb51fd"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">传引用？还是传值？</span></span></h2><div id="https://www.notion.so/a8791b4eb3eb4800bbf7933bfd4a4fd7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">先说结论：Go是值传递，所有类型数据都会拷贝一个副本到函数里面。</span></span></p></div><div id="https://www.notion.so/b0d06777a6964e4ba89049d937185069" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">但是Go又把数据类型分为两种：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/516167e46948465386333b9ca57cc8e8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">引用类型：指针、slice、map、channel、接口、函数等</span></span></li><li id="https://www.notion.so/83db597ac0ec46a6868a617a19641c07" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">非引用类型：int、string、float、bool、数组和struct</span></span></li></ul><div id="https://www.notion.so/1670418913e24632ac89276a292b4cd7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">引用类型传递的时候依然会拷贝一个副本，但是这个副本和引用指向了同一个对象，因此函数内的修改会影响原引用数据</span></span></p></div><div id="https://www.notion.so/ec6c640bb6ab49c08846d2c32557ba15" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">而非引用类型就是普通的值传递了，不会影响到原有的数据</span></span></p></div><pre id="https://www.notion.so/6c95654248294b119ceadf1b6a8d20c2" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>func TestModify(t *testing.T) {
	a := 1
	modifyInt(a)
	fmt.Println(a) // 没有改变

	b := make([]int, 3)
	modifySlice(b)
	fmt.Println(b) // 被改变了
}</span></span></span></code></pre><div id="https://www.notion.so/46243713dd1c4089aa75d991cec4f6bc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">输出结果：</span></span></p></div><pre id="https://www.notion.so/b761c9e2aa2d4bad9cd6207a5311ad95" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>-1
1
[1 0 0]
[1 0 0]</span></span></span></code></pre><div id="https://www.notion.so/758326cc6ba6466985357124b8795b5b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h1 id="https://www.notion.so/36089ade6f7e4952833e808c14ec02e9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/36089ade6f7e4952833e808c14ec02e9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Ref</span></span></h1><div id="https://www.notion.so/4402e288e4544b84acbb4132bb766f97" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://sanyuesha.com/2017/07/26/go-make-and-new/">理解 Go make 和 new 的区别 | 三月沙 (sanyuesha.com)</a></span></span></p></div><div id="https://www.notion.so/3983b233f792425ca23631bba5649b04" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.nhooo.com/golang/go-comparing-pointers.html">Go 语言指针比较 - Golang教程 - 基础教程在线 (nhooo.com)</a></span></span></p></div><div id="https://www.notion.so/bd3bc092c5e04dd284e1bda764d95958" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://zhuanlan.zhihu.com/p/383737884">Go的参数是传值还是传引用问题 - 知乎 (zhihu.com)</a></span></span></p></div></article>
  <footer class="Footer">
  <div>&copy; Notablog 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>