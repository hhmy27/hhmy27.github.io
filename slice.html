<!DOCTYPE html><html lang="zh-CN"><head><meta name="viewport" content="width=device-width"/><title>聊聊 Go 的 slice</title><meta name="robots" content="follow, index"/><meta charSet="UTF-8"/><meta name="keywords" content="Blog, Notion, Tech, Python, Django"/><meta name="description" content="通过源码分析slice"/><meta property="og:locale" content="zh-CN"/><meta property="og:title" content="聊聊 Go 的 slice"/><meta property="og:description" content="通过源码分析slice"/><meta property="og:url" content="https://hhmy27.github.io/"/><meta property="og:image" content="https://og-image-craigary.vercel.app/%E8%81%8A%E8%81%8A%20Go%20%E7%9A%84%20slice.png?theme=dark&amp;md=1&amp;fontSize=125px&amp;images=https%3A%2F%2Fnobelium.vercel.app%2Flogo-for-dark-bg.svg"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:description" content="通过源码分析slice"/><meta name="twitter:title" content="聊聊 Go 的 slice"/><meta name="twitter:image" content="https://og-image-craigary.vercel.app/%E8%81%8A%E8%81%8A%20Go%20%E7%9A%84%20slice.png?theme=dark&amp;md=1&amp;fontSize=125px&amp;images=https%3A%2F%2Fnobelium.vercel.app%2Flogo-for-dark-bg.svg"/><meta property="article:published_time"/><meta property="article:author" content="hhmy"/><meta name="next-head-count" content="18"/><link rel="preload" href="/fonts/IBMPlexSansVar-Roman.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/IBMPlexSansVar-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="preload" as="style" data-href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&amp;display=swap"/><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&amp;display=swap"/><noscript><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&amp;display=swap"/></noscript><link rel="icon" href="/favicon.svg" type="image/svg+xml"/><link rel="icon" href="/favicon.ico"/><link rel="apple-touch-icon" sizes="192x192" href="/apple-touch-icon.png"/><link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/feed"/><meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)"/><meta name="theme-color" content="#18181B" media="(prefers-color-scheme: dark)"/><link rel="preload" href="/_next/static/css/8e8bd7c50b2739f5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e8bd7c50b2739f5.css" data-n-g=""/><link rel="preload" href="/_next/static/css/6a5815369e10547f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6a5815369e10547f.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-c0a56147c8fcef8f.js" defer=""></script><script src="/_next/static/chunks/main-e557dee8cfeafd6c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-175b96479fa559f6.js" defer=""></script><script src="/_next/static/chunks/b5f2ed29-08db60af0c3043ba.js" defer=""></script><script src="/_next/static/chunks/684-63c1a25e215d8bed.js" defer=""></script><script src="/_next/static/chunks/580-72b0d7719056af92.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-03011df04807c853.js" defer=""></script><script src="/_next/static/3bOJ__T0UyKqwK2TxNz68/_buildManifest.js" defer=""></script><script src="/_next/static/3bOJ__T0UyKqwK2TxNz68/_ssgManifest.js" defer=""></script><script src="/_next/static/3bOJ__T0UyKqwK2TxNz68/_middlewareManifest.js" defer=""></script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap"/></head><body class="bg-day dark:bg-night"><div id="__next" data-reactroot=""><div><div class="wrapper font-sans"><div class="observer-element h-4 md:h-12"></div><div class="sticky-nav m-auto w-full h-6 flex flex-row justify-between items-center mb-2 md:mb-12 py-8 bg-opacity-60 max-w-3xl px-4" id="sticky-nav"><div class="flex items-center"><a aria-label="hhmy 的博客" href="/"><div class="h-6"><svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="14" cy="14" r="14" class="fill-current text-black dark:text-white"></circle><circle cx="14" cy="14" r="14" fill="url(#paint0_radial)"></circle><circle cx="8" cy="8" r="1.5" fill="white"></circle><defs><radialGradient id="paint0_radial" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="rotate(45) scale(39.598)"><stop stop-color="#3399FF" stop-opacity="0.9"></stop><stop offset="1" stop-color="#FF3399" stop-opacity="0.6"></stop></radialGradient></defs></svg></div></a><p class="ml-2 font-medium text-day dark:text-night header-name">聊聊 Go 的 slice</p></div><div class="flex-shrink-0"><ul class="flex flex-row"><li class="block ml-4 text-black dark:text-gray-50 nav"><a href="/about">关于</a></li><li class="block ml-4 text-black dark:text-gray-50 nav"><a href="/search">搜索</a></li></ul></div></div><main class="m-auto flex-grow w-full transition-all max-w-3xl px-4"><article><h1 class="font-bold text-3xl text-black dark:text-white"> <!-- -->聊聊 Go 的 slice</h1><nav class="flex mt-7 items-start text-gray-500 dark:text-gray-400"><div class="flex mb-4"><a href="https://github.com/hhmy27" class="flex"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2724%27%20height=%2724%27/%3e"/></span><img alt="hhmy" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="hhmy" srcSet="https://gravatar.com/avatar/c8089598dc27a7944c95a8ed30867b78?imwidth=32 1x, https://gravatar.com/avatar/c8089598dc27a7944c95a8ed30867b78?imwidth=48 2x" src="https://gravatar.com/avatar/c8089598dc27a7944c95a8ed30867b78?imwidth=48" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="rounded-full" loading="lazy"/></noscript></span><p class="ml-2 md:block">hhmy</p></a><span class="block"> / </span></div><div class="mr-2 mb-4 md:ml-0">2022 年 11 月 20 日</div><div class="flex flex-nowrap max-w-full overflow-x-auto article-tags"><a href="/tag/Go"><p class="mr-1 rounded-full px-2 py-1 border leading-none text-sm dark:border-gray-600">Go</p></a></div></nav><div class="-mt-4"><main class="notion light-mode notion-page notion-block-ed276d453e9140f4b3f7559061948489"><div class="notion-viewport"></div><div class="notion-collection-row"><div class="notion-collection-row-body"><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M10.889 5.5H3.11v1.556h7.778V5.5zm1.555-4.444h-.777V0H10.11v1.056H3.89V0H2.333v1.056h-.777c-.864 0-1.548.7-1.548 1.555L0 12.5c0 .856.692 1.5 1.556 1.5h10.888C13.3 14 14 13.356 14 12.5V2.611c0-.855-.7-1.555-1.556-1.555zm0 11.444H1.556V3.944h10.888V12.5zM8.556 8.611H3.11v1.556h5.445V8.61z"></path></svg><div class="notion-collection-column-title-body">date</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-date">Nov 20, 2022</span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">slug</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text">slice</span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 13A6 6 0 107 1a6 6 0 000 12zM3.751 5.323A.2.2 0 013.909 5h6.182a.2.2 0 01.158.323L7.158 9.297a.2.2 0 01-.316 0L3.751 5.323z"></path></svg><div class="notion-collection-column-title-body">status</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-select"><div class="notion-property-select-item notion-item-red">Published</div></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M4 3a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zm0 4a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zm0 4a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zM2 4a1 1 0 110-2 1 1 0 010 2zm0 4a1 1 0 110-2 1 1 0 010 2zm0 4a1 1 0 110-2 1 1 0 010 2z"></path></svg><div class="notion-collection-column-title-body">tags</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-multi_select"><div class="notion-property-multi_select-item notion-item-default">Go</div></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">summary</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text">通过源码分析slice</span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 13A6 6 0 107 1a6 6 0 000 12zM3.751 5.323A.2.2 0 013.909 5h6.182a.2.2 0 01.158.323L7.158 9.297a.2.2 0 01-.316 0L3.751 5.323z"></path></svg><div class="notion-collection-column-title-body">type</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-select"><div class="notion-property-select-item notion-item-purple">Post</div></span></div></div></div></div><div class="notion-table-of-contents notion-gray notion-block-bee150871fde4b1cbd4e958755ce42cd"><a href="#0d1b38c882ad46fdb186f3b4af64e890" class="notion-table-of-contents-item"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">查看slice的源码</span></a><a href="#b58282d0f068407b84c4415bd40ed44a" class="notion-table-of-contents-item"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">slice的初始化</span></a><a href="#96d380b7ecf94d1390f8ab6bcf282d53" class="notion-table-of-contents-item"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">slice的扩容机制</span></a><a href="#0544a40b35f941b0a5e15b1fdd0fea81" class="notion-table-of-contents-item"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:24px">step 1. 步长</span></a><a href="#1d520e60088a438196033605ea112e4b" class="notion-table-of-contents-item"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:24px">step 2. 内存对齐</span></a><a href="#b8ea8a743b7547b9afe37016e9d02d7b" class="notion-table-of-contents-item"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:24px">总结</span></a><a href="#140a6d0f54004b3caa47abd1c65f52ad" class="notion-table-of-contents-item"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">slice的拷贝</span></a><a href="#1b0c90c1f9d547ba8ceae8e57c874be5" class="notion-table-of-contents-item"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:24px">slice遍历的坑</span></a><a href="#4b2034c183954853b014953d8d61528e" class="notion-table-of-contents-item"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">一些问题</span></a><a href="#757d0ca7c7a24bfda45057a9bf0282f0" class="notion-table-of-contents-item"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">总结</span></a><a href="#e9f2d4601ba5407a9ac107f59828d6e8" class="notion-table-of-contents-item"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">Ref</span></a></div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-0d1b38c882ad46fdb186f3b4af64e890" data-id="0d1b38c882ad46fdb186f3b4af64e890"><span><div id="0d1b38c882ad46fdb186f3b4af64e890" class="notion-header-anchor"></div><a class="notion-hash-link" href="#0d1b38c882ad46fdb186f3b4af64e890" title="查看slice的源码"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">查看slice的源码</span></span></h2><div class="notion-text notion-block-afecb652d8c7499fa8b37e236d8038ee">查看go的版本</div><pre class="notion-code language-bash"><code class="language-bash">$ go version
go version go1.16.15 darwin/arm64</code></pre><div class="notion-text notion-block-a33a5f82359c41709eb13db2a27c3fdc">切换到我们的go安装路径，输入</div><pre class="notion-code language-bash"><code class="language-bash">$ <span class="token function">grep</span> -n <span class="token string">"type slice struct"</span> -r ./</code></pre><div class="notion-text notion-block-3efd2554ee4848e6948e17e340d11f33">得到输出</div><pre class="notion-code language-bash"><code class="language-bash">.//src/cmd/compile/internal/gc/go.go:77:// <span class="token builtin class-name">type</span> slice struct <span class="token punctuation">{</span>
.//src/runtime/slice.go:13:type slice struct <span class="token punctuation">{</span></code></pre><div class="notion-text notion-block-d975d1bfb0b141a8a12d180b28839997">我们直接进<code class="notion-inline-code">slice.go</code> 这个文件看下</div><div class="notion-text notion-block-c410af47283548019f1e53a1e9cd346d">算上注释也就300行不到的代码，短小精悍，看看定义和函数列表</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-0ba992f76fff4750a224825dced20631"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:contain" src="https://www.notion.so/image/https%3A%2F%2Fs3.us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc570d58b-7992-4cca-b1c1-ad9aea894226%2FUntitled.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45EIPT3X45%252F20230129%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20230129T100549Z%26X-Amz-Expires%3D86400%26X-Amz-Signature%3Dbb3d6fe020cb412e61111293b3adf874d8732c723e053f7fcda80a18fbb1d053%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject?table=block&amp;id=0ba992f7-6fff-4750-a224-825dced20631&amp;cache=v2" loading="lazy" alt="notion image" decoding="async"/></div></figure><div class="notion-text notion-block-1997db5fab8544fbb33a846172d48e3d">结构体定义</div><pre class="notion-code language-go"><code class="language-go"><span class="token keyword">type</span> slice <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	array unsafe<span class="token punctuation">.</span>Pointer    <span class="token comment">// 底层数组</span>
	<span class="token builtin">len</span>   <span class="token builtin">int</span>               <span class="token comment">// 数组长度</span>
	<span class="token builtin">cap</span>   <span class="token builtin">int</span>               <span class="token comment">// 数组容量</span>
<span class="token punctuation">}</span></code></pre><div class="notion-text notion-block-a59fd1a70e294cebb69c405cf67d90c6">slice是在底层的数组上面包了一层，array是指向底层数组的指针，底层数组是真正存储值的地方。而len和cap和分别表示数组当前长度和数组的容量，slice根据它们的大小关系来进行扩容。</div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-b58282d0f068407b84c4415bd40ed44a" data-id="b58282d0f068407b84c4415bd40ed44a"><span><div id="b58282d0f068407b84c4415bd40ed44a" class="notion-header-anchor"></div><a class="notion-hash-link" href="#b58282d0f068407b84c4415bd40ed44a" title="slice的初始化"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">slice的初始化</span></span></h2><div class="notion-text notion-block-f8ccd834d0004691abb56a46410f2f3e">我们初始化一个slice，可以有两种方法，分别是：</div><pre class="notion-code language-go"><code class="language-go"><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>    <span class="token comment">// 初始化size为5，cap为5的slice</span>
<span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">// 初始化size为0，cap为5的slice，推荐使用该方式</span>
<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">...</span> <span class="token punctuation">}</span> <span class="token comment">// 直接给定值声明</span></code></pre><div class="notion-text notion-block-847b28c8de4a4c49ba6aa40b049a9746">对于slice来说，make的第一个参数指定存储类型，这里是<code class="notion-inline-code">int</code>，第二个是size，可选为0，第三个是cap，指定容量</div><div class="notion-text notion-block-a4e3964a2af44c22b039ad68cc7bc7a1">我们一般推荐使用第二种方式，指定好cap，避免扩容带来的开销，而size我们一般指定为0，表示不存储任何元素。</div><div class="notion-text notion-block-774d631d482546ab9b481829ced121c3">如果我们指定了size，那么会在生成size个默认值在slice中，比如说int类型的默认值就是0。请看下面的打印结果</div><pre class="notion-code language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">TestSlice</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		a <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	b <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		b <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	c <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 输出</span>
<span class="token comment">// [0 0 0 0 0 1 2 3 4 5] 10 10</span>
<span class="token comment">// [1 2 3 4 5] 5 10</span></code></pre><div class="notion-text notion-block-6a0b2874c3c04edca5ca741634a50d9e">用<code class="notion-inline-code">make([]int, size)</code> 方式初始化，很容易忘记我们已经存储了若干个值了。除非我们真的需要这样的slice，不然还是用第二种初始化方式比较好。</div><div class="notion-text notion-block-c38290ed650d438ebf219a8c045a85f4">下面我们看看初始化的源码：</div><pre class="notion-code language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">makeslice</span><span class="token punctuation">(</span>et <span class="token operator">*</span>_type<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">,</span> <span class="token builtin">cap</span> <span class="token builtin">int</span><span class="token punctuation">)</span> unsafe<span class="token punctuation">.</span>Pointer <span class="token punctuation">{</span>
	mem<span class="token punctuation">,</span> overflow <span class="token operator">:=</span> math<span class="token punctuation">.</span><span class="token function">MulUintptr</span><span class="token punctuation">(</span>et<span class="token punctuation">.</span>size<span class="token punctuation">,</span> <span class="token function">uintptr</span><span class="token punctuation">(</span><span class="token builtin">cap</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> overflow <span class="token operator">||</span> mem <span class="token operator">></span> maxAlloc <span class="token operator">||</span> <span class="token builtin">len</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token builtin">len</span> <span class="token operator">></span> <span class="token builtin">cap</span> <span class="token punctuation">{</span>
		<span class="token comment">// NOTE: Produce a 'len out of range' error instead of a</span>
		<span class="token comment">// 'cap out of range' error when someone does make([]T, bignumber).</span>
		<span class="token comment">// 'cap out of range' is true too, but since the cap is only being</span>
		<span class="token comment">// supplied implicitly, saying len is clearer.</span>
		<span class="token comment">// See golang.org/issue/4085.</span>
		mem<span class="token punctuation">,</span> overflow <span class="token operator">:=</span> math<span class="token punctuation">.</span><span class="token function">MulUintptr</span><span class="token punctuation">(</span>et<span class="token punctuation">.</span>size<span class="token punctuation">,</span> <span class="token function">uintptr</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> overflow <span class="token operator">||</span> mem <span class="token operator">></span> maxAlloc <span class="token operator">||</span> <span class="token builtin">len</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
			<span class="token function">panicmakeslicelen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token function">panicmakeslicecap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token function">mallocgc</span><span class="token punctuation">(</span>mem<span class="token punctuation">,</span> et<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><div class="notion-text notion-block-2a4c454c815740a3a305d4bdff6aa84b">外部的逻辑是检查我们开的容量会不会溢出，如果溢出就抛出panic，否则的话调用<code class="notion-inline-code">mallocgc</code> 进行初始化，mallocgc的源码涉及到一些go内存分配的知识，这里就不展开了，感兴趣可以自己看看。</div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-96d380b7ecf94d1390f8ab6bcf282d53" data-id="96d380b7ecf94d1390f8ab6bcf282d53"><span><div id="96d380b7ecf94d1390f8ab6bcf282d53" class="notion-header-anchor"></div><a class="notion-hash-link" href="#96d380b7ecf94d1390f8ab6bcf282d53" title="slice的扩容机制"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">slice的扩容机制</span></span></h2><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-0544a40b35f941b0a5e15b1fdd0fea81" data-id="0544a40b35f941b0a5e15b1fdd0fea81"><span><div id="0544a40b35f941b0a5e15b1fdd0fea81" class="notion-header-anchor"></div><a class="notion-hash-link" href="#0544a40b35f941b0a5e15b1fdd0fea81" title="step 1. 步长"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">step 1. 步长</span></span></h3><div class="notion-text notion-block-3ff3b7a98c5f43c0ae151afb2e790da7">当我们len超过cap的时候就会触发扩容，实际调用的函数是<code class="notion-inline-code">growslice</code>，我们来看看go是怎么实现的</div><pre class="notion-code language-go"><code class="language-go"><span class="token comment">// growslice handles slice growth during append.</span>
<span class="token comment">// It is passed the slice element type, the old slice, and the desired new minimum capacity,</span>
<span class="token comment">// and it returns a new slice with at least that capacity, with the old data</span>
<span class="token comment">// copied into it.</span>
<span class="token comment">// The new slice's length is set to the old slice's length,</span>
<span class="token comment">// NOT to the new requested capacity.</span>
<span class="token comment">// This is for codegen convenience. The old slice's length is used immediately</span>
<span class="token comment">// to calculate where to write new values during an append.</span>
<span class="token comment">// TODO: When the old backend is gone, reconsider this decision.</span>
<span class="token comment">// The SSA backend might prefer the new length or to return only ptr/cap and save stack space.</span>
<span class="token keyword">func</span> <span class="token function">growslice</span><span class="token punctuation">(</span>et <span class="token operator">*</span>_type<span class="token punctuation">,</span> old slice<span class="token punctuation">,</span> <span class="token builtin">cap</span> <span class="token builtin">int</span><span class="token punctuation">)</span> slice <span class="token punctuation">{</span>
	<span class="token operator">...</span>
	
	newcap <span class="token operator">:=</span> old<span class="token punctuation">.</span><span class="token builtin">cap</span>
		doublecap <span class="token operator">:=</span> newcap <span class="token operator">+</span> newcap
		<span class="token keyword">if</span> <span class="token builtin">cap</span> <span class="token operator">></span> doublecap <span class="token punctuation">{</span>
			newcap <span class="token operator">=</span> <span class="token builtin">cap</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> old<span class="token punctuation">.</span><span class="token builtin">cap</span> <span class="token operator">&lt;</span> <span class="token number">1024</span> <span class="token punctuation">{</span>
				newcap <span class="token operator">=</span> doublecap
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token comment">// Check 0 &lt; newcap to detect overflow</span>
				<span class="token comment">// and prevent an infinite loop.</span>
				<span class="token keyword">for</span> <span class="token number">0</span> <span class="token operator">&lt;</span> newcap <span class="token operator">&amp;&amp;</span> newcap <span class="token operator">&lt;</span> <span class="token builtin">cap</span> <span class="token punctuation">{</span>
					newcap <span class="token operator">+=</span> newcap <span class="token operator">/</span> <span class="token number">4</span>
				<span class="token punctuation">}</span>
				<span class="token comment">// Set newcap to the requested cap when</span>
				<span class="token comment">// the newcap calculation overflowed.</span>
				<span class="token keyword">if</span> newcap <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
					newcap <span class="token operator">=</span> <span class="token builtin">cap</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token operator">...</span>
<span class="token punctuation">}</span></code></pre><table class="notion-simple-table notion-block-91665dd778264dc69173aebebe417922"><tbody><tr class="notion-simple-table-row notion-block-c87f560e793f4ff990bf3befb4594c3a"><td class="" style="width:120px"><div class="notion-simple-table-cell">变量</div></td><td class="" style="width:120px"><div class="notion-simple-table-cell">含义</div></td></tr><tr class="notion-simple-table-row notion-block-48ea1d88513b4be7a2ba208a799e86f4"><td class="" style="width:120px"><div class="notion-simple-table-cell">cap</div></td><td class="" style="width:120px"><div class="notion-simple-table-cell">期望容量</div></td></tr><tr class="notion-simple-table-row notion-block-6f5da4024d214869a132ea621a54ada9"><td class="" style="width:120px"><div class="notion-simple-table-cell">old.cap</div></td><td class="" style="width:120px"><div class="notion-simple-table-cell">当前容量</div></td></tr><tr class="notion-simple-table-row notion-block-6225e51f3b7044a0a34065205638d61e"><td class="" style="width:120px"><div class="notion-simple-table-cell">doublecap</div></td><td class="" style="width:120px"><div class="notion-simple-table-cell">当前容量的两倍</div></td></tr><tr class="notion-simple-table-row notion-block-5f4dd636ebe249ec8e1f49f4d844cd31"><td class="" style="width:120px"><div class="notion-simple-table-cell">newcap</div></td><td class="" style="width:120px"><div class="notion-simple-table-cell">最终容量</div></td></tr></tbody></table><div class="notion-text notion-block-6b141b6ece554837b7541bb577142844">决策逻辑：</div><ul class="notion-list notion-list-disc notion-block-5576d2cab7c1459f9d39cde67e3d47cd"><li>如果期望容量超过当前容量的两倍，直接设置为期望容量，否则</li></ul><ul class="notion-list notion-list-disc notion-block-9c204879903a43d6a3850999ba4c425b"><li>如果当前容量的值小于1024，直接翻倍，否则</li></ul><ul class="notion-list notion-list-disc notion-block-6a23c330381a423d9f90ab851485a243"><li>如果newcap &lt; cap，不断以1.25倍的速度增长</li></ul><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-87cb9adbe52b4a258daa75edb8b69b64"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:contain" src="https://www.notion.so/image/https%3A%2F%2Fs3.us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb8eced42-e046-4d89-894b-f3331bc1b6e5%2FUntitled.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45EIPT3X45%252F20230129%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20230129T100549Z%26X-Amz-Expires%3D86400%26X-Amz-Signature%3D78c15380a4311effab419d6e370db45ce6f563d1a39acea59500e468a3fcf53f%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject?table=block&amp;id=87cb9adb-e52b-4a25-8daa-75edb8b69b64&amp;cache=v2" loading="lazy" alt="notion image" decoding="async"/></div></figure><div class="notion-blank notion-block-dcf4343653f6413b9a4d5da029a8e0c9"> </div><div class="notion-text notion-block-6afb7cb8c8e34df5a77cb4ce981e2da6">对于1.25倍扩增速度，go的1.18.1版本作出了优化</div><pre class="notion-code language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">growslice</span><span class="token punctuation">(</span>et <span class="token operator">*</span>_type<span class="token punctuation">,</span> old slice<span class="token punctuation">,</span> <span class="token builtin">cap</span> <span class="token builtin">int</span><span class="token punctuation">)</span> slice <span class="token punctuation">{</span>
	<span class="token operator">...</span>	
	newcap <span class="token operator">:=</span> old<span class="token punctuation">.</span><span class="token builtin">cap</span>
	doublecap <span class="token operator">:=</span> newcap <span class="token operator">+</span> newcap
	<span class="token keyword">if</span> <span class="token builtin">cap</span> <span class="token operator">></span> doublecap <span class="token punctuation">{</span>
			newcap <span class="token operator">=</span> <span class="token builtin">cap</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">const</span> threshold <span class="token operator">=</span> <span class="token number">256</span>
			<span class="token keyword">if</span> old<span class="token punctuation">.</span><span class="token builtin">cap</span> <span class="token operator">&lt;</span> threshold <span class="token punctuation">{</span>
					newcap <span class="token operator">=</span> doublecap
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token comment">// Check 0 &lt; newcap to detect overflow</span>
					<span class="token comment">// and prevent an infinite loop.</span>
					<span class="token keyword">for</span> <span class="token number">0</span> <span class="token operator">&lt;</span> newcap <span class="token operator">&amp;&amp;</span> newcap <span class="token operator">&lt;</span> <span class="token builtin">cap</span> <span class="token punctuation">{</span>
							<span class="token comment">// Transition from growing 2x for small slices</span>
							<span class="token comment">// to growing 1.25x for large slices. This formula</span>
							<span class="token comment">// gives a smooth-ish transition between the two.</span>
							newcap <span class="token operator">+=</span> <span class="token punctuation">(</span>newcap <span class="token operator">+</span> <span class="token number">3</span><span class="token operator">*</span>threshold<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">4</span>
					<span class="token punctuation">}</span>
					<span class="token comment">// Set newcap to the requested cap when</span>
					<span class="token comment">// the newcap calculation overflowed.</span>
					<span class="token keyword">if</span> newcap <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
							newcap <span class="token operator">=</span> <span class="token builtin">cap</span>
					<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token operator">...</span>
<span class="token punctuation">}</span></code></pre><div class="notion-text notion-block-08f6a449235d4ed8b8af6abd7625f009">这里的区别就是<code class="notion-inline-code">newcap += (newcap + 3*threshold) / 4</code> ，注释上说相比于旧版本，这里增长速度更加smooth，具体效果可以用python画图模拟一下，这里就不展开了。
</div><div class="notion-text notion-block-ae3a778d52d74d049744e99ce404c9ec">下面我们来看一段代码，看看结果是不是和我们上面分析得一样</div><pre class="notion-code language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">TestSlice</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token comment">// 此时c满</span>
	c <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token comment">// 此时按照计算公式，期望容量为5，当前容量为2，则c的最终容量是5</span>
	c <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
	<span class="token comment">// 猜测为5 5</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><div class="notion-text notion-block-9fe6c4dd964842b6801a79234485dc1d">但是输出结果是<code class="notion-inline-code">5 6</code>，cap被设置成了6，这是为什么呢？原因是go还会进行内存对齐</div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-1d520e60088a438196033605ea112e4b" data-id="1d520e60088a438196033605ea112e4b"><span><div id="1d520e60088a438196033605ea112e4b" class="notion-header-anchor"></div><a class="notion-hash-link" href="#1d520e60088a438196033605ea112e4b" title="step 2. 内存对齐"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">step 2. 内存对齐</span></span></h3><pre class="notion-code language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">growslice</span><span class="token punctuation">(</span>et <span class="token operator">*</span>_type<span class="token punctuation">,</span> old slice<span class="token punctuation">,</span> <span class="token builtin">cap</span> <span class="token builtin">int</span><span class="token punctuation">)</span> slice <span class="token punctuation">{</span>
	<span class="token operator">...</span>

	newcap <span class="token operator">:=</span> old<span class="token punctuation">.</span><span class="token builtin">cap</span>
	doublecap <span class="token operator">:=</span> newcap <span class="token operator">+</span> newcap
	<span class="token keyword">if</span> <span class="token builtin">cap</span> <span class="token operator">></span> doublecap <span class="token punctuation">{</span>
		newcap <span class="token operator">=</span> <span class="token builtin">cap</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> old<span class="token punctuation">.</span><span class="token builtin">cap</span> <span class="token operator">&lt;</span> <span class="token number">1024</span> <span class="token punctuation">{</span>
			newcap <span class="token operator">=</span> doublecap
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">// Check 0 &lt; newcap to detect overflow</span>
			<span class="token comment">// and prevent an infinite loop.</span>
			<span class="token keyword">for</span> <span class="token number">0</span> <span class="token operator">&lt;</span> newcap <span class="token operator">&amp;&amp;</span> newcap <span class="token operator">&lt;</span> <span class="token builtin">cap</span> <span class="token punctuation">{</span>
				newcap <span class="token operator">+=</span> newcap <span class="token operator">/</span> <span class="token number">4</span>
			<span class="token punctuation">}</span>
			<span class="token comment">// Set newcap to the requested cap when</span>
			<span class="token comment">// the newcap calculation overflowed.</span>
			<span class="token keyword">if</span> newcap <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
				newcap <span class="token operator">=</span> <span class="token builtin">cap</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">var</span> overflow <span class="token builtin">bool</span>
	<span class="token keyword">var</span> lenmem<span class="token punctuation">,</span> newlenmem<span class="token punctuation">,</span> capmem <span class="token builtin">uintptr</span>
	<span class="token comment">// Specialize for common values of et.size.</span>
	<span class="token comment">// For 1 we don't need any division/multiplication.</span>
	<span class="token comment">// For sys.PtrSize, compiler will optimize division/multiplication into a shift by a constant.</span>
	<span class="token comment">// For powers of 2, use a variable shift.</span>
	<span class="token keyword">switch</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> et<span class="token punctuation">.</span>size <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
		<span class="token operator">...</span>
	<span class="token keyword">case</span> et<span class="token punctuation">.</span>size <span class="token operator">==</span> sys<span class="token punctuation">.</span>PtrSize<span class="token punctuation">:</span>
		<span class="token operator">...</span>
	<span class="token keyword">case</span> <span class="token function">isPowerOfTwo</span><span class="token punctuation">(</span>et<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">var</span> shift <span class="token builtin">uintptr</span>
		<span class="token keyword">if</span> sys<span class="token punctuation">.</span>PtrSize <span class="token operator">==</span> <span class="token number">8</span> <span class="token punctuation">{</span>
			<span class="token comment">// Mask shift for better code generation.</span>
			shift <span class="token operator">=</span> <span class="token function">uintptr</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function">Ctz64</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span>et<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">63</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			shift <span class="token operator">=</span> <span class="token function">uintptr</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function">Ctz32</span><span class="token punctuation">(</span><span class="token function">uint32</span><span class="token punctuation">(</span>et<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">31</span>
		<span class="token punctuation">}</span>
		lenmem <span class="token operator">=</span> <span class="token function">uintptr</span><span class="token punctuation">(</span>old<span class="token punctuation">.</span><span class="token builtin">len</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> shift
		newlenmem <span class="token operator">=</span> <span class="token function">uintptr</span><span class="token punctuation">(</span><span class="token builtin">cap</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> shift
		capmem <span class="token operator">=</span> <span class="token function">roundupsize</span><span class="token punctuation">(</span><span class="token function">uintptr</span><span class="token punctuation">(</span>newcap<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> shift<span class="token punctuation">)</span>
		overflow <span class="token operator">=</span> <span class="token function">uintptr</span><span class="token punctuation">(</span>newcap<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token punctuation">(</span>maxAlloc <span class="token operator">>></span> shift<span class="token punctuation">)</span>
		newcap <span class="token operator">=</span> <span class="token function">int</span><span class="token punctuation">(</span>capmem <span class="token operator">>></span> shift<span class="token punctuation">)</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
		<span class="token operator">...</span>
	<span class="token punctuation">}</span>
	<span class="token operator">...</span>

	<span class="token keyword">return</span> slice<span class="token punctuation">{</span>p<span class="token punctuation">,</span> old<span class="token punctuation">.</span><span class="token builtin">len</span><span class="token punctuation">,</span> newcap<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="notion-text notion-block-4ee3bdc04a584bcb924d9c8529d6920d">et.size指的是存储元素类型的大小，这里int类型字节是8，使用下面的函数判断通过</div><pre class="notion-code language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">isPowerOfTwo</span><span class="token punctuation">(</span>x <span class="token builtin">uintptr</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> x<span class="token operator">&amp;</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>
<span class="token punctuation">}</span></code></pre><div class="notion-text notion-block-1c4689cfe01d4d2e8723a763730600af">先不看代码，我们分析一下怎么内存对齐：</div><div class="notion-text notion-block-cc5a94670ea4443799fc764ca742730a">我们的slice现在存储了5个元素，int类型8个字节，则新的存储容量大小<code class="notion-inline-code">newcap = 5 * 8 = 40</code>，但是为了更好的内存分配减少碎片，go使用了和c一样的内存对齐策略，使用<code class="notion-inline-code">roundupsize</code> 向上调整大小，这里调整成了48，那么最终的<code class="notion-inline-code">cap = 48 / 8 = 6</code>，所以在上面的例子cap被设置为了6</div><div class="notion-text notion-block-d81f5fc71ef04fc0a1ec7c2e84ca0509"><b>为什么被调整到48呢？</b></div><div class="notion-text notion-block-c58832783f0841378fba00e27e1040f7">原因是Go语言的内存管理通常把这些内存块都预先申请好，并且被分为常用的规格，比如8，16， 32， 48， 64等，当我们申请40 bytes的时候，会申请一个足够大的内存块给我们，这就返回的是48 bytes</div><div class="notion-text notion-block-9354acb8e7cb4e3cb912ed480592071a">至于怎么设置的呢，这里有两个很巧妙的函数 <code class="notion-inline-code">Ctz64</code> 和 <code class="notion-inline-code">roundupsize</code></div><pre class="notion-code language-go"><code class="language-go"><span class="token comment">// Ctz64 counts trailing (low-order) zeroes,</span>
<span class="token comment">// and if all are zero, then 64.</span>
<span class="token comment">// 返回x中末尾0的个数</span>
<span class="token keyword">func</span> <span class="token function">Ctz64</span><span class="token punctuation">(</span>x <span class="token builtin">uint64</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	x <span class="token operator">&amp;=</span> <span class="token operator">-</span>x                       <span class="token comment">// isolate low-order bit</span>
	y <span class="token operator">:=</span> x <span class="token operator">*</span> deBruijn64ctz <span class="token operator">>></span> <span class="token number">58</span>  <span class="token comment">// extract part of deBruijn sequence</span>
	i <span class="token operator">:=</span> <span class="token function">int</span><span class="token punctuation">(</span>deBruijnIdx64ctz<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// convert to bit index</span>
	z <span class="token operator">:=</span> <span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">57</span> <span class="token operator">&amp;</span> <span class="token number">64</span><span class="token punctuation">)</span>  <span class="token comment">// adjustment if zero</span>
	<span class="token keyword">return</span> i <span class="token operator">+</span> z
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">roundupsize</span><span class="token punctuation">(</span>size <span class="token builtin">uintptr</span><span class="token punctuation">)</span> <span class="token builtin">uintptr</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> size <span class="token operator">&lt;</span> _MaxSmallSize <span class="token punctuation">{</span>
		<span class="token keyword">if</span> size <span class="token operator">&lt;=</span> smallSizeMax<span class="token operator">-</span><span class="token number">8</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token function">uintptr</span><span class="token punctuation">(</span>class_to_size<span class="token punctuation">[</span>size_to_class8<span class="token punctuation">[</span><span class="token function">divRoundUp</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> smallSizeDiv<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token function">uintptr</span><span class="token punctuation">(</span>class_to_size<span class="token punctuation">[</span>size_to_class128<span class="token punctuation">[</span><span class="token function">divRoundUp</span><span class="token punctuation">(</span>size<span class="token operator">-</span>smallSizeMax<span class="token punctuation">,</span> largeSizeDiv<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> size<span class="token operator">+</span>_PageSize <span class="token operator">&lt;</span> size <span class="token punctuation">{</span>
		<span class="token keyword">return</span> size
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token function">alignUp</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> _PageSize<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// alignUp rounds n up to a multiple of a. a must be a power of 2.</span>
<span class="token keyword">func</span> <span class="token function">alignUp</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> a <span class="token builtin">uintptr</span><span class="token punctuation">)</span> <span class="token builtin">uintptr</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>n <span class="token operator">+</span> a <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;^</span> <span class="token punctuation">(</span>a <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// &amp;^ 是 ANT NOT 运算符</span></code></pre><div class="notion-text notion-block-c134267980374d3b83931449ae8c9bf8">然后我们再看这一块代码</div><pre class="notion-code language-go"><code class="language-go">	<span class="token keyword">case</span> <span class="token function">isPowerOfTwo</span><span class="token punctuation">(</span>et<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">var</span> shift <span class="token builtin">uintptr</span>
		<span class="token keyword">if</span> sys<span class="token punctuation">.</span>PtrSize <span class="token operator">==</span> <span class="token number">8</span> <span class="token punctuation">{</span>
			<span class="token comment">// Mask shift for better code generation.</span>
			shift <span class="token operator">=</span> <span class="token function">uintptr</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function">Ctz64</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span>et<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">63</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			shift <span class="token operator">=</span> <span class="token function">uintptr</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function">Ctz32</span><span class="token punctuation">(</span><span class="token function">uint32</span><span class="token punctuation">(</span>et<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">31</span>
		<span class="token punctuation">}</span>
		capmem <span class="token operator">=</span> <span class="token function">roundupsize</span><span class="token punctuation">(</span><span class="token function">uintptr</span><span class="token punctuation">(</span>newcap<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> shift<span class="token punctuation">)</span>
		newcap <span class="token operator">=</span> <span class="token function">int</span><span class="token punctuation">(</span>capmem <span class="token operator">>></span> shift<span class="token punctuation">)</span></code></pre><div class="notion-text notion-block-8926da40cd3f4a10985c182093f6442e">首先我们通过<code class="notion-inline-code">Ctz64(et.size)</code> 得到shift的值，int类型是8个字节，则8的二进制末尾有3个0，我们得到<code class="notion-inline-code">shift=3</code></div><div class="notion-text notion-block-51080fc4ba1041ff8d38ef97f182da16">然后<code class="notion-inline-code">newcap&lt;&lt;shift</code> 就是 <code class="notion-inline-code">5 &lt;&lt; 3</code> 得到40</div><div class="notion-text notion-block-7b5963cc69864eb3950c6c036d81d96b">经过<code class="notion-inline-code">roundupsize</code>，得到<code class="notion-inline-code">capmem = 48</code></div><div class="notion-text notion-block-f7dc82a409f5475bbccfbb8507df2309">最终再还原回来 <code class="notion-inline-code">newcap = int(48 &gt;&gt; 3) = 6</code></div><div class="notion-text notion-block-cc4483358a9845e48da9efd9067e1d3c">这样就能内存对齐啦</div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-b8ea8a743b7547b9afe37016e9d02d7b" data-id="b8ea8a743b7547b9afe37016e9d02d7b"><span><div id="b8ea8a743b7547b9afe37016e9d02d7b" class="notion-header-anchor"></div><a class="notion-hash-link" href="#b8ea8a743b7547b9afe37016e9d02d7b" title="总结"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">总结</span></span></h3><div class="notion-text notion-block-6b1d36fcc9de4b9f863b08968543a079">slice的扩容步骤有两步</div><ol start="1" class="notion-list notion-list-numbered notion-block-4af00b0decc740e4ae0b0188bb303f74"><li>调整期望容量</li><ol class="notion-list notion-list-numbered notion-block-4af00b0decc740e4ae0b0188bb303f74"><li>如果期望容量是当前容量的两倍，直接更新，否则</li><li>如果小于1024，直接翻倍当前容量，否则</li><li>当前容量按照1.25的速度增长，直到超过期望容量</li></ol></ol><ol start="2" class="notion-list notion-list-numbered notion-block-8c5c7f0f90574973a38f57cabfd20b1e"><li>进行内存对齐，向上调整到最接近的2的n次幂</li></ol><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-140a6d0f54004b3caa47abd1c65f52ad" data-id="140a6d0f54004b3caa47abd1c65f52ad"><span><div id="140a6d0f54004b3caa47abd1c65f52ad" class="notion-header-anchor"></div><a class="notion-hash-link" href="#140a6d0f54004b3caa47abd1c65f52ad" title="slice的拷贝"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">slice的拷贝</span></span></h2><div class="notion-text notion-block-94d43a124e1244d8ac21b03c270b05f7">切片拷贝的方法是slicecopy，我们看看是怎么做的：</div><pre class="notion-code language-go"><code class="language-go"><span class="token comment">// slicecopy is used to copy from a string or slice of pointerless elements into a slice.</span>
<span class="token keyword">func</span> <span class="token function">slicecopy</span><span class="token punctuation">(</span>toPtr unsafe<span class="token punctuation">.</span>Pointer<span class="token punctuation">,</span> toLen <span class="token builtin">int</span><span class="token punctuation">,</span> fromPtr unsafe<span class="token punctuation">.</span>Pointer<span class="token punctuation">,</span> fromLen <span class="token builtin">int</span><span class="token punctuation">,</span> width <span class="token builtin">uintptr</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token comment">// 如果有一个长度为0，提前退出</span>
	<span class="token keyword">if</span> fromLen <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> toLen <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">0</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 记录下较短的长度</span>
	n <span class="token operator">:=</span> fromLen
	<span class="token keyword">if</span> toLen <span class="token operator">&lt;</span> n <span class="token punctuation">{</span>
		n <span class="token operator">=</span> toLen
	<span class="token punctuation">}</span>
	<span class="token comment">// 如果指定的长度为0，那么提前退出</span>
	<span class="token keyword">if</span> width <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> n
	<span class="token punctuation">}</span>

	size <span class="token operator">:=</span> <span class="token function">uintptr</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">*</span> width
	<span class="token operator">...</span>

	<span class="token keyword">if</span> size <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span> <span class="token comment">// common case worth about 2x to do here</span>
		<span class="token comment">// TODO: is this still worth it with new memmove impl?</span>

		<span class="token comment">// 如果只有一个长度，直接指针转换即可</span>
		<span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">byte</span><span class="token punctuation">)</span><span class="token punctuation">(</span>toPtr<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">byte</span><span class="token punctuation">)</span><span class="token punctuation">(</span>fromPtr<span class="token punctuation">)</span> <span class="token comment">// known to be a byte pointer</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token comment">// 从from.array 移动 size 个 bytes 拷贝到 to.array</span>
		<span class="token function">memmove</span><span class="token punctuation">(</span>toPtr<span class="token punctuation">,</span> fromPtr<span class="token punctuation">,</span> size<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> n
<span class="token punctuation">}</span></code></pre><div class="notion-text notion-block-e9bf6c44b3df40bb885335598a46e9fb">执行看看效果</div><pre class="notion-code language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">TestCopy</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
	b <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
	c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
	n <span class="token operator">:=</span> <span class="token function">copy</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
	n <span class="token operator">=</span> <span class="token function">copy</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> a<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// === RUN   TestCopy</span>
<span class="token comment">// [1 2 3 0 0] 3</span>
<span class="token comment">// [1 2] 2</span>
<span class="token comment">// --- PASS: TestCopy (0.00s)</span></code></pre><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-1b0c90c1f9d547ba8ceae8e57c874be5" data-id="1b0c90c1f9d547ba8ceae8e57c874be5"><span><div id="1b0c90c1f9d547ba8ceae8e57c874be5" class="notion-header-anchor"></div><a class="notion-hash-link" href="#1b0c90c1f9d547ba8ceae8e57c874be5" title="slice遍历的坑"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">slice遍历的坑</span></span></h3><div class="notion-text notion-block-c2e5bb09c3ac48479e6b1bd743842807">但是我们拷贝有一个需要注意的地方：</div><pre class="notion-code language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">TestFor</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">}</span>
	<span class="token keyword">for</span> index<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> slice <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"value = %d , value-addr = %x , slice-addr = %x\n"</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token operator">&amp;</span>value<span class="token punctuation">,</span> <span class="token operator">&amp;</span>slice<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="notion-text notion-block-afaa2b8897244edaa545d7dc3edc10c6">输出：</div><pre class="notion-code language-go"><code class="language-go"><span class="token operator">==</span><span class="token operator">=</span> RUN   TestFor
value <span class="token operator">=</span> <span class="token number">10</span> <span class="token punctuation">,</span> value<span class="token operator">-</span>addr <span class="token operator">=</span> <span class="token number">1400001e250</span> <span class="token punctuation">,</span> slice<span class="token operator">-</span>addr <span class="token operator">=</span> 1400001a0a0
value <span class="token operator">=</span> <span class="token number">20</span> <span class="token punctuation">,</span> value<span class="token operator">-</span>addr <span class="token operator">=</span> <span class="token number">1400001e250</span> <span class="token punctuation">,</span> slice<span class="token operator">-</span>addr <span class="token operator">=</span> 1400001a0a8
value <span class="token operator">=</span> <span class="token number">30</span> <span class="token punctuation">,</span> value<span class="token operator">-</span>addr <span class="token operator">=</span> <span class="token number">1400001e250</span> <span class="token punctuation">,</span> slice<span class="token operator">-</span>addr <span class="token operator">=</span> 1400001a0b0
value <span class="token operator">=</span> <span class="token number">40</span> <span class="token punctuation">,</span> value<span class="token operator">-</span>addr <span class="token operator">=</span> <span class="token number">1400001e250</span> <span class="token punctuation">,</span> slice<span class="token operator">-</span>addr <span class="token operator">=</span> 1400001a0b8
<span class="token operator">--</span><span class="token operator">-</span> PASS<span class="token punctuation">:</span> TestFor <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">.</span>00s<span class="token punctuation">)</span></code></pre><div class="notion-text notion-block-a268f40a20284b86bdca0dff0ffccc83">可以看到，我们用range去遍历切片的时候，拿到的value其实是切片里面的<b>值拷贝</b>，所以每次Value的地址都不变。因此我们需要用<code class="notion-inline-code">&amp;slice[index]</code>才能拿到真实的地址</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-1d6ec7d17d9a4e97bf68fa41b4982844"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:contain" src="https://www.notion.so/image/https%3A%2F%2Fs3.us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F07b1c3a3-a71d-49ab-af2d-f7b440c6c984%2FUntitled.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45EIPT3X45%252F20230129%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20230129T100549Z%26X-Amz-Expires%3D86400%26X-Amz-Signature%3D06f6e055f83fbd6ab564e5080d01d64fb0d6e985ceb85eeae8e5d863ee536e6e%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject?table=block&amp;id=1d6ec7d1-7d9a-4e97-bf68-fa41b4982844&amp;cache=v2" loading="lazy" alt="notion image" decoding="async"/></div></figure><div class="notion-text notion-block-e7b42623807b4efea632dd74b2dfa3af">ref: <a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://halfrost.com/go_slice/">深入解析 Go 中 Slice 底层实现 (halfrost.com)</a></div><div class="notion-text notion-block-552b3b9e15124057ae02d0c5c88c0065">如果不注意到这点的话，会带来什么问题呢？当我们拷贝的时候可能就会踩坑了：</div><pre class="notion-code language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">TestFor</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">}</span>
	to <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>slice<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> slice <span class="token punctuation">{</span>
		to <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> <span class="token operator">&amp;</span>value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> to <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">*</span>value<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="notion-text notion-block-64da06b3034548a3bc8be0d94d666d34">输出：</div><pre class="notion-code language-go"><code class="language-go"><span class="token operator">==</span><span class="token operator">=</span> RUN   TestFor
<span class="token number">40</span> <span class="token number">0x14000098168</span>
<span class="token number">40</span> <span class="token number">0x14000098168</span>
<span class="token number">40</span> <span class="token number">0x14000098168</span>
<span class="token number">40</span> <span class="token number">0x14000098168</span>
<span class="token operator">--</span><span class="token operator">-</span> PASS<span class="token punctuation">:</span> TestFor <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">.</span>00s<span class="token punctuation">)</span></code></pre><div class="notion-text notion-block-18e2c75dadc442408916bef5faca7341">可以发现，每次append到to里面的地址都是创建的临时变量value，而value最后的值是40，所以导致最后输出值都是40，且指向的地址就是value的地址。</div><div class="notion-text notion-block-b8c22ae95b264b519f6656c97b85cd71">要避免这个坑，我们要记住for遍历的时候会创建临时变量，避免直接对临时变量操作。</div><pre class="notion-code language-go"><code class="language-go"><span class="token comment">// 方法一，直接操作slice的值</span>
<span class="token keyword">for</span> index<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> <span class="token keyword">range</span> slice <span class="token punctuation">{</span>
		to <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> <span class="token operator">&amp;</span>slice<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 方法二，创建临时变量</span>
<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> slice <span class="token punctuation">{</span>
		tmp <span class="token operator">:=</span> value
		to <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tmp<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><div class="notion-blank notion-block-867c81b0f9ac41e29617ac99ea63c4c5"> </div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-4b2034c183954853b014953d8d61528e" data-id="4b2034c183954853b014953d8d61528e"><span><div id="4b2034c183954853b014953d8d61528e" class="notion-header-anchor"></div><a class="notion-hash-link" href="#4b2034c183954853b014953d8d61528e" title="一些问题"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">一些问题</span></span></h2><ul class="notion-list notion-list-disc notion-block-6a1099bcde724398837d79a59cb1152d"><li>为什么1024之后的扩展速度变为1.25倍呢？</li></ul><div class="notion-text notion-block-0d770c11df914472969ab9bc2171893e">因为内存空间很宝贵，底层的数组是在内存中连续的空间，申请这样大规模连续的空间是很昂贵的，1024之后我们用1.25的速度扩展已经足够大了，这样相比于翻倍扩展能解决更多的空间</div><ul class="notion-list notion-list-disc notion-block-57056f1caeed4253a0b3f96f75d42790"><li>为什么要内存对齐？</li></ul><div class="notion-text notion-block-0153dc81cf6a4e07b02f5029049a3b2d">因为内存管理会预先申请内存后再进行分配，预先申请的大小都是常用的规格，比如说8，16，32，48，64等，因此我们需要进行内存对齐来返回一个足够大的内存块使用。这样避免任意大小的内存块产生内存碎片，影响空间申请和整理。</div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-757d0ca7c7a24bfda45057a9bf0282f0" data-id="757d0ca7c7a24bfda45057a9bf0282f0"><span><div id="757d0ca7c7a24bfda45057a9bf0282f0" class="notion-header-anchor"></div><a class="notion-hash-link" href="#757d0ca7c7a24bfda45057a9bf0282f0" title="总结"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">总结</span></span></h2><div class="notion-text notion-block-1f83c65485034579beb19f4e60b509c8">简单介绍了一下slice的代码，短小精悍，主要有初始化、扩容、拷贝三种操作。</div><div class="notion-text notion-block-3cb61869eaa640718349e0a5e3b767e8">日常使用的时候，我们最好指定cap的上限，避免扩容带来的开销。同时避免切片遍历的坑。</div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-e9f2d4601ba5407a9ac107f59828d6e8" data-id="e9f2d4601ba5407a9ac107f59828d6e8"><span><div id="e9f2d4601ba5407a9ac107f59828d6e8" class="notion-header-anchor"></div><a class="notion-hash-link" href="#e9f2d4601ba5407a9ac107f59828d6e8" title="Ref"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Ref</span></span></h2><div class="notion-text notion-block-e898e6fc27194768848554f709455f1f"><a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://www.lookcos.cn/archives/1204.html">浅谈 Go 1.18.1的切片扩容机制 - Lookcos 的网络日志</a></div><div class="notion-text notion-block-ed0dee31697e4624927dbae5d18df021"><a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://halfrost.com/go_slice/">深入解析 Go 中 Slice 底层实现 (halfrost.com)</a></div><div class="notion-text notion-block-137d2d198a1b43acba370b4dd8a39568"><a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://tiancaiamao.gitbooks.io/go-internals/content/zh/02.2.html">slice · 深入解析Go (gitbooks.io)</a></div><div class="notion-text notion-block-75fe0674fd2549d6a601d6fad808de90"><a target="_blank" rel="noopener noreferrer" class="notion-link" href="http://lifegoeson.cn/2022/01/22/golang%20slice%E6%89%A9%E5%AE%B9%E6%9C%BA%E5%88%B6/">golang slice扩容机制 (lifegoeson.cn)</a></div><div class="notion-text notion-block-7c4ea0076f194c1d95f25ba833253d73"><a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://eddycjy.gitbook.io/golang/di-1-ke-za-tan/go-memory-align">1.5 在 Go 中恰到好处的内存对齐 - 跟煎鱼学 Go (gitbook.io)</a></div><div class="notion-text notion-block-189017a165734ddc8e8542292793cfe0"><a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://zhuanlan.zhihu.com/p/86765504">go：&amp;^ 运算符 - 知乎 (zhihu.com)</a></div></main></div></article><div class="flex justify-between font-medium text-gray-500 dark:text-gray-400"><a><button class="mt-2 cursor-pointer hover:text-black dark:hover:text-gray-100">← <!-- -->返回</button></a><a><button class="mt-2 cursor-pointer hover:text-black dark:hover:text-gray-100">↑ <!-- -->回到顶部</button></a></div><div></div></main><div class="mt-6 flex-shrink-0 m-auto w-full text-gray-500 dark:text-gray-400 transition-all max-w-3xl px-4"><hr class="border-gray-200 dark:border-gray-600"/><div class="my-4 text-sm leading-6"><div class="flex align-baseline justify-between flex-wrap"><p>© <!-- -->hhmy<!-- --> <!-- -->2019 - 2023</p><p>powered by <a href="https://github.com/craigary/nobelium"><u>nobelium</u></a></p></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"ed276d45-3e91-40f4-b3f7-559061948489","date":{"start_date":"2022-11-20"},"type":["Post"],"slug":"slice","tags":["Go"],"summary":"通过源码分析slice","title":"聊聊 Go 的 slice","status":["Published"],"createdTime":"Fri Dec 16 2022 08:30:49 GMT+0000 (Coordinated Universal Time)","fullWidth":false,"pageIcon":null,"pageCover":null},"blockMap":{"block":{"ed276d45-3e91-40f4-b3f7-559061948489":{"role":"reader","value":{"id":"ed276d45-3e91-40f4-b3f7-559061948489","version":75,"type":"page","properties":{"!`\"w":[["Yes"]],"98uZ":[["通过源码分析slice"]],":H`m":[["Yes"]],"NX\\Q":[["‣",[["d",{"type":"date","start_date":"2022-11-20"}]]]],"`gQ~":[["Post"]],"d]hq":[["slice"]],"sD^m":[["Go"]],"wz|S":[["通过源码分析slice"]],"xY$N":[["‣",[["d",{"type":"date","start_date":"2022-11-20"}]]]],"{iD?":[["Go"]],"|Ay0":[["post"]],"title":[["聊聊 Go 的 slice"]],"f211bdc0-ee00-4186-9a7d-f68c055ec2ee":[["Published"]]},"content":["bee15087-1fde-4b1c-bd4e-958755ce42cd","0d1b38c8-82ad-46fd-b186-f3b4af64e890","afecb652-d8c7-499f-a8b3-7e236d8038ee","4929fe98-9740-47c2-82c8-97126b77d3c9","a33a5f82-359c-4170-9eb1-3db2a27c3fdc","122986fc-a41a-42d2-9cd7-330024d02514","3efd2554-ee48-48e6-948e-17e340d11f33","95a9e185-a205-4131-ab30-da8ed142fe4c","d975d1bf-b0b1-41a8-a12d-180b28839997","c410af47-2835-4801-9f1e-53a1e9cd346d","0ba992f7-6fff-4750-a224-825dced20631","1997db5f-ab85-44fb-b33a-846172d48e3d","fb4e26e5-faf4-46ef-9b7a-0809bd323cea","a59fd1a7-0e29-4ceb-b69c-405cf67d90c6","b58282d0-f068-407b-84c4-415bd40ed44a","f8ccd834-d000-4691-abb5-6a46410f2f3e","6e648eba-83f4-4486-b714-ee1418003ecf","847b28c8-de4a-4c49-ba6a-a40b049a9746","a4e3964a-2af4-4c22-b039-ad68cc7bc7a1","774d631d-4825-46ab-9b48-1829ced121c3","cc22b7be-a703-46b0-bacd-7eb8d813bcc4","6a0b2874-c3c0-4edc-a5ca-741634a50d9e","c38290ed-650d-438e-bf21-9a8c045a85f4","7cfc3812-2e43-4d97-9a76-b2623a0be9f9","2a4c454c-8157-40a3-a305-d4bdff6aa84b","96d380b7-ecf9-4d13-90f8-ab6bcf282d53","0544a40b-35f9-41b0-a5e1-5b1fdd0fea81","3ff3b7a9-8c5f-43c0-ae15-1afb2e790da7","3d6d2e5a-9b80-43c5-8fc2-7c9d91e65b05","91665dd7-7826-4dc6-9173-aebebe417922","6b141b6e-ce55-4837-b754-1bb577142844","5576d2ca-b7c1-459f-9d39-cde67e3d47cd","9c204879-903a-43d6-a385-0999ba4c425b","6a23c330-381a-423d-9f90-ab851485a243","87cb9adb-e52b-4a25-8daa-75edb8b69b64","dcf43436-53f6-413b-9a4d-5da029a8e0c9","6afb7cb8-c8e3-4df5-a77c-b4ce981e2da6","d18fbc5d-c971-467b-8a06-c24f9a70b841","08f6a449-235d-4ed8-b8af-6abd7625f009","ae3a778d-52d7-4d04-9744-e99ce404c9ec","2b59c5b6-b00f-416c-9f71-d1d86592a449","9fe6c4dd-9648-42b6-801a-79234485dc1d","1d520e60-088a-4381-9603-3605ea112e4b","1d3bb36d-7488-4c5d-963e-b2c33b83174c","4ee3bdc0-4a58-4bcb-924d-9c8529d6920d","c81c9ac2-31b1-4699-8414-8b93d8444ea9","1c4689cf-e01d-4d2e-8723-a763730600af","cc5a9467-0ea4-4437-99fc-764ca742730a","d81f5fc7-1ef0-4fc0-a1ec-7c2e84ca0509","c5883278-3f08-4137-8fba-00e27e1040f7","9354acb8-e7cb-4e3c-b912-ed480592071a","b3ad5d1e-3d30-4248-bd95-6d8751a07a28","c1342679-8037-4d3b-8393-1449ae8c9bf8","8a86710c-c0bc-4fc8-8e20-02da04f2a267","8926da40-cd3f-4a10-985c-182093f6442e","51080fc4-ba10-41ff-8d38-ef97f182da16","7b5963cc-6986-4eb3-950c-6c036d81d96b","f7dc82a4-09f5-475b-bccf-bb8507df2309","cc448335-8a98-45e4-8da9-efd9067e1d3c","b8ea8a74-3b75-47b9-afe3-7016e9d02d7b","6b1d36fc-c9de-4b9f-863b-08968543a079","4af00b0d-ecc7-40e4-ae0b-0188bb303f74","8c5c7f0f-9057-4973-a38f-57cabfd20b1e","140a6d0f-5400-4b3c-aa47-abd1c65f52ad","94d43a12-4e12-44d8-ac21-b03c270b05f7","1b7bbb7f-d6ff-4eb0-a86f-12dbd385ae21","e9bf6c44-b3df-40bb-8853-35598a46e9fb","b74ad982-9f2a-440f-9414-0c759437916e","1b0c90c1-f9d5-47ba-8cea-e8e57c874be5","c2e5bb09-c3ac-4847-9e6b-1bd743842807","95f0f27e-986a-4ae7-931d-ef4a94cfc84f","afaa2b88-9724-4eda-a545-d7dc3edc10c6","60f73379-bd8e-4990-88d2-696313bc3b97","a268f40a-2028-4b86-bdca-0dff0ffccc83","1d6ec7d1-7d9a-4e97-bf68-fa41b4982844","e7b42623-807b-4efe-a632-dd74b2dfa3af","552b3b9e-1512-4057-ae02-d0c5c88c0065","751e2e38-d07f-42c5-b2d8-6266ad83ecc2","64da06b3-0345-48a3-bc8b-e0d94d666d34","9d2b2a3d-5dee-4175-94ce-d47ff598a6d9","18e2c75d-adc4-4240-8916-bef5faca7341","b8c22ae9-5b26-4b51-9f66-56c97b85cd71","732eff97-3199-4002-a488-1528000b25f4","867c81b0-f9ac-41e2-9617-ac99ea63c4c5","4b2034c1-8395-4853-b014-953d8d61528e","6a1099bc-de72-4398-837d-79a59cb1152d","0d770c11-df91-4472-969a-b9bc2171893e","57056f1c-aeed-4253-a0b3-f96f75d42790","0153dc81-cf6a-4e07-b02f-5029049a3b2d","757d0ca7-c7a2-4bfd-a450-57a9bf0282f0","1f83c654-8503-4579-beb1-9f4e60b509c8","3cb61869-eaa6-4071-8349-e0a5e3b767e8","e9f2d460-1ba5-407a-9ac1-07f59828d6e8","e898e6fc-2719-4768-8485-54f709455f1f","ed0dee31-697e-4624-927d-bae5d18df021","137d2d19-8a1b-43ac-ba37-0b4dd8a39568","75fe0674-fd25-49d6-a601-d6fad808de90","7c4ea007-6f19-4c1d-95f2-5ba833253d73","189017a1-6573-4ddc-8e85-42292793cfe0"],"format":{"copied_from_pointer":{"id":"f57661f8-70a1-4ee6-a868-09224dcbb50a","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671627060000,"parent_id":"a3ce75fe-7085-406b-a33f-74958ef7ee13","parent_table":"collection","alive":true,"copied_from":"f57661f8-70a1-4ee6-a868-09224dcbb50a","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"1d21f050-c8c4-41f3-9fd4-8ff7de49c962":{"role":"reader","value":{"id":"1d21f050-c8c4-41f3-9fd4-8ff7de49c962","version":52,"type":"collection_view_page","view_ids":["876cf270-3f6b-4f1a-b6c8-5ffbd27ca40f"],"collection_id":"a3ce75fe-7085-406b-a33f-74958ef7ee13","format":{"block_locked":false,"block_locked_by":"2c0e0b01-f59e-4e03-b7b6-7d706eecada3","collection_pointer":{"id":"a3ce75fe-7085-406b-a33f-74958ef7ee13","table":"collection","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"},"copied_from_pointer":{"id":"866916e3-b939-468b-9b6f-1d47dce99f9c","table":"block","spaceId":"ac4cb96d-c8f8-4040-9bb2-868d9fc7f526"}},"permissions":[{"role":"editor","type":"user_permission","user_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec"},{"role":"reader","type":"public_permission","added_timestamp":1671187403441}],"created_time":1670483100421,"last_edited_time":1674968741252,"parent_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4","parent_table":"space","alive":true,"copied_from":"866916e3-b939-468b-9b6f-1d47dce99f9c","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"bee15087-1fde-4b1c-bd4e-958755ce42cd":{"role":"reader","value":{"id":"bee15087-1fde-4b1c-bd4e-958755ce42cd","version":1,"type":"table_of_contents","format":{"block_color":"gray","copied_from_pointer":{"id":"2d29f8c6-e008-42ea-b6a8-e3b89e11802c","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"2d29f8c6-e008-42ea-b6a8-e3b89e11802c","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"0d1b38c8-82ad-46fd-b186-f3b4af64e890":{"role":"reader","value":{"id":"0d1b38c8-82ad-46fd-b186-f3b4af64e890","version":1,"type":"header","properties":{"title":[["查看slice的源码"]]},"format":{"copied_from_pointer":{"id":"88ccdf21-bf6f-4f47-ad63-bc6148b4eb77","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"88ccdf21-bf6f-4f47-ad63-bc6148b4eb77","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"afecb652-d8c7-499f-a8b3-7e236d8038ee":{"role":"reader","value":{"id":"afecb652-d8c7-499f-a8b3-7e236d8038ee","version":1,"type":"text","properties":{"title":[["查看go的版本"]]},"format":{"copied_from_pointer":{"id":"463196f2-e0df-4e8b-a913-0f80d8ae3783","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"463196f2-e0df-4e8b-a913-0f80d8ae3783","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"4929fe98-9740-47c2-82c8-97126b77d3c9":{"role":"reader","value":{"id":"4929fe98-9740-47c2-82c8-97126b77d3c9","version":1,"type":"code","properties":{"title":[["$ go version\ngo version go1.16.15 darwin/arm64"]],"language":[["Bash"]]},"format":{"copied_from_pointer":{"id":"3f6960b1-cb3c-40b2-972c-bca4fdec9b1d","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"3f6960b1-cb3c-40b2-972c-bca4fdec9b1d","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"a33a5f82-359c-4170-9eb1-3db2a27c3fdc":{"role":"reader","value":{"id":"a33a5f82-359c-4170-9eb1-3db2a27c3fdc","version":1,"type":"text","properties":{"title":[["切换到我们的go安装路径，输入"]]},"format":{"copied_from_pointer":{"id":"9e4eaa94-7193-43fb-b21a-b796eb50d9a7","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"9e4eaa94-7193-43fb-b21a-b796eb50d9a7","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"122986fc-a41a-42d2-9cd7-330024d02514":{"role":"reader","value":{"id":"122986fc-a41a-42d2-9cd7-330024d02514","version":1,"type":"code","properties":{"title":[["$ grep -n \"type slice struct\" -r ./"]],"language":[["Bash"]]},"format":{"copied_from_pointer":{"id":"ae09624b-2756-4cb1-b2df-19546e9cfccc","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"ae09624b-2756-4cb1-b2df-19546e9cfccc","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"3efd2554-ee48-48e6-948e-17e340d11f33":{"role":"reader","value":{"id":"3efd2554-ee48-48e6-948e-17e340d11f33","version":1,"type":"text","properties":{"title":[["得到输出"]]},"format":{"copied_from_pointer":{"id":"e0ee1f84-4f37-4a4b-8260-f85c1b31206e","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"e0ee1f84-4f37-4a4b-8260-f85c1b31206e","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"95a9e185-a205-4131-ab30-da8ed142fe4c":{"role":"reader","value":{"id":"95a9e185-a205-4131-ab30-da8ed142fe4c","version":1,"type":"code","properties":{"title":[[".//src/cmd/compile/internal/gc/go.go:77:// type slice struct {\n.//src/runtime/slice.go:13:type slice struct {"]],"language":[["Bash"]]},"format":{"copied_from_pointer":{"id":"59ebe073-f38d-4d53-9002-269f9be25ab1","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"59ebe073-f38d-4d53-9002-269f9be25ab1","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"d975d1bf-b0b1-41a8-a12d-180b28839997":{"role":"reader","value":{"id":"d975d1bf-b0b1-41a8-a12d-180b28839997","version":1,"type":"text","properties":{"title":[["我们直接进"],["slice.go",[["c"]]],[" 这个文件看下"]]},"format":{"copied_from_pointer":{"id":"0c7a2711-07d5-4a4c-9b7e-75de8568e498","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"0c7a2711-07d5-4a4c-9b7e-75de8568e498","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"c410af47-2835-4801-9f1e-53a1e9cd346d":{"role":"reader","value":{"id":"c410af47-2835-4801-9f1e-53a1e9cd346d","version":1,"type":"text","properties":{"title":[["算上注释也就300行不到的代码，短小精悍，看看定义和函数列表"]]},"format":{"copied_from_pointer":{"id":"c51c915e-b902-4192-bc79-1eba01ee0286","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"c51c915e-b902-4192-bc79-1eba01ee0286","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"0ba992f7-6fff-4750-a224-825dced20631":{"role":"reader","value":{"id":"0ba992f7-6fff-4750-a224-825dced20631","version":1,"type":"image","properties":{"size":[["84.0KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c570d58b-7992-4cca-b1c1-ad9aea894226/Untitled.png"]]},"format":{"block_width":978,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c570d58b-7992-4cca-b1c1-ad9aea894226/Untitled.png","block_full_width":false,"block_page_width":true,"block_aspect_ratio":0.6687116564417178,"copied_from_pointer":{"id":"4a491e20-e800-4cee-a0f6-b874ee5c4b7c","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"},"block_preserve_scale":true},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"4a491e20-e800-4cee-a0f6-b874ee5c4b7c","file_ids":["c570d58b-7992-4cca-b1c1-ad9aea894226"],"created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"1997db5f-ab85-44fb-b33a-846172d48e3d":{"role":"reader","value":{"id":"1997db5f-ab85-44fb-b33a-846172d48e3d","version":1,"type":"text","properties":{"title":[["结构体定义"]]},"format":{"copied_from_pointer":{"id":"061795a4-7bb1-4c20-8518-c1afcf5f82de","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"061795a4-7bb1-4c20-8518-c1afcf5f82de","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"fb4e26e5-faf4-46ef-9b7a-0809bd323cea":{"role":"reader","value":{"id":"fb4e26e5-faf4-46ef-9b7a-0809bd323cea","version":1,"type":"code","properties":{"title":[["type slice struct {\n\tarray unsafe.Pointer    // 底层数组\n\tlen   int               // 数组长度\n\tcap   int               // 数组容量\n}"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"a70ea140-29d5-4267-a5fd-4ee51d16df2b","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"a70ea140-29d5-4267-a5fd-4ee51d16df2b","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"a59fd1a7-0e29-4ceb-b69c-405cf67d90c6":{"role":"reader","value":{"id":"a59fd1a7-0e29-4ceb-b69c-405cf67d90c6","version":1,"type":"text","properties":{"title":[["slice是在底层的数组上面包了一层，array是指向底层数组的指针，底层数组是真正存储值的地方。而len和cap和分别表示数组当前长度和数组的容量，slice根据它们的大小关系来进行扩容。"]]},"format":{"copied_from_pointer":{"id":"f4328227-61ce-4d10-ab7a-753b0a927920","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"f4328227-61ce-4d10-ab7a-753b0a927920","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"b58282d0-f068-407b-84c4-415bd40ed44a":{"role":"reader","value":{"id":"b58282d0-f068-407b-84c4-415bd40ed44a","version":1,"type":"header","properties":{"title":[["slice的初始化"]]},"format":{"copied_from_pointer":{"id":"aff44efa-9edf-4075-ace3-e737a7ef6760","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"aff44efa-9edf-4075-ace3-e737a7ef6760","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"f8ccd834-d000-4691-abb5-6a46410f2f3e":{"role":"reader","value":{"id":"f8ccd834-d000-4691-abb5-6a46410f2f3e","version":1,"type":"text","properties":{"title":[["我们初始化一个slice，可以有两种方法，分别是："]]},"format":{"copied_from_pointer":{"id":"b63dd477-26f4-4b14-9d35-059c30bbb89c","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"b63dd477-26f4-4b14-9d35-059c30bbb89c","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"6e648eba-83f4-4486-b714-ee1418003ecf":{"role":"reader","value":{"id":"6e648eba-83f4-4486-b714-ee1418003ecf","version":1,"type":"code","properties":{"title":[["make([]int, 5)    // 初始化size为5，cap为5的slice\nmake([]int, 0, 5) // 初始化size为0，cap为5的slice，推荐使用该方式\n[]int{1, 2, ... } // 直接给定值声明"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"6197dcc3-75bd-4043-8083-b101c41cbd1f","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"6197dcc3-75bd-4043-8083-b101c41cbd1f","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"847b28c8-de4a-4c49-ba6a-a40b049a9746":{"role":"reader","value":{"id":"847b28c8-de4a-4c49-ba6a-a40b049a9746","version":1,"type":"text","properties":{"title":[["对于slice来说，make的第一个参数指定存储类型，这里是"],["int",[["c"]]],["，第二个是size，可选为0，第三个是cap，指定容量"]]},"format":{"copied_from_pointer":{"id":"53d2ef4d-f1df-4f7b-8d7d-b6d18742ad18","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"53d2ef4d-f1df-4f7b-8d7d-b6d18742ad18","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"a4e3964a-2af4-4c22-b039-ad68cc7bc7a1":{"role":"reader","value":{"id":"a4e3964a-2af4-4c22-b039-ad68cc7bc7a1","version":1,"type":"text","properties":{"title":[["我们一般推荐使用第二种方式，指定好cap，避免扩容带来的开销，而size我们一般指定为0，表示不存储任何元素。"]]},"format":{"copied_from_pointer":{"id":"60f8c796-54b0-4a31-9ec2-484bd6021452","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"60f8c796-54b0-4a31-9ec2-484bd6021452","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"774d631d-4825-46ab-9b48-1829ced121c3":{"role":"reader","value":{"id":"774d631d-4825-46ab-9b48-1829ced121c3","version":1,"type":"text","properties":{"title":[["如果我们指定了size，那么会在生成size个默认值在slice中，比如说int类型的默认值就是0。请看下面的打印结果"]]},"format":{"copied_from_pointer":{"id":"660d984b-7463-430d-9e24-829a5a5d7ecd","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"660d984b-7463-430d-9e24-829a5a5d7ecd","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"cc22b7be-a703-46b0-bacd-7eb8d813bcc4":{"role":"reader","value":{"id":"cc22b7be-a703-46b0-bacd-7eb8d813bcc4","version":1,"type":"code","properties":{"title":[["func TestSlice(t *testing.T) {\n\ta := make([]int, 5)\n\tfor i := 1; i \u003c= 5; i++ {\n\t\ta = append(a, i)\n\t}\n\tb := make([]int, 0, 10)\n\tfor i := 1; i \u003c= 5; i++ {\n\t\tb = append(b, i)\n\t}\n\tc := []int{1, 2, 3, 4, 5}\n\tfmt.Println(a, len(a), cap(a))\n\tfmt.Println(b, len(b), cap(b))\n\tfmt.Println(c, len(c), cap(c))\n}\n// 输出\n// [0 0 0 0 0 1 2 3 4 5] 10 10\n// [1 2 3 4 5] 5 10"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"60a21e85-6acc-49a9-a7f1-2d04cd10687e","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"60a21e85-6acc-49a9-a7f1-2d04cd10687e","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"6a0b2874-c3c0-4edc-a5ca-741634a50d9e":{"role":"reader","value":{"id":"6a0b2874-c3c0-4edc-a5ca-741634a50d9e","version":1,"type":"text","properties":{"title":[["用"],["make([]int, size)",[["c"]]],[" 方式初始化，很容易忘记我们已经存储了若干个值了。除非我们真的需要这样的slice，不然还是用第二种初始化方式比较好。"]]},"format":{"copied_from_pointer":{"id":"b5e6c644-2ba4-462b-8524-6259bc751ab2","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"b5e6c644-2ba4-462b-8524-6259bc751ab2","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"c38290ed-650d-438e-bf21-9a8c045a85f4":{"role":"reader","value":{"id":"c38290ed-650d-438e-bf21-9a8c045a85f4","version":1,"type":"text","properties":{"title":[["下面我们看看初始化的源码："]]},"format":{"copied_from_pointer":{"id":"2f8de26d-12e5-48ab-a3d8-bc3591379c93","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"2f8de26d-12e5-48ab-a3d8-bc3591379c93","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"7cfc3812-2e43-4d97-9a76-b2623a0be9f9":{"role":"reader","value":{"id":"7cfc3812-2e43-4d97-9a76-b2623a0be9f9","version":1,"type":"code","properties":{"title":[["func makeslice(et *_type, len, cap int) unsafe.Pointer {\n\tmem, overflow := math.MulUintptr(et.size, uintptr(cap))\n\tif overflow || mem \u003e maxAlloc || len \u003c 0 || len \u003e cap {\n\t\t// NOTE: Produce a 'len out of range' error instead of a\n\t\t// 'cap out of range' error when someone does make([]T, bignumber).\n\t\t// 'cap out of range' is true too, but since the cap is only being\n\t\t// supplied implicitly, saying len is clearer.\n\t\t// See golang.org/issue/4085.\n\t\tmem, overflow := math.MulUintptr(et.size, uintptr(len))\n\t\tif overflow || mem \u003e maxAlloc || len \u003c 0 {\n\t\t\tpanicmakeslicelen()\n\t\t}\n\t\tpanicmakeslicecap()\n\t}\n\n\treturn mallocgc(mem, et, true)\n}"]],"language":[["Go"]]},"format":{"code_wrap":true,"copied_from_pointer":{"id":"b11c4f0d-4bcb-45f5-9ec4-e09793270a1c","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"b11c4f0d-4bcb-45f5-9ec4-e09793270a1c","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"2a4c454c-8157-40a3-a305-d4bdff6aa84b":{"role":"reader","value":{"id":"2a4c454c-8157-40a3-a305-d4bdff6aa84b","version":1,"type":"text","properties":{"title":[["外部的逻辑是检查我们开的容量会不会溢出，如果溢出就抛出panic，否则的话调用"],["mallocgc",[["c"]]],[" 进行初始化，mallocgc的源码涉及到一些go内存分配的知识，这里就不展开了，感兴趣可以自己看看。"]]},"format":{"copied_from_pointer":{"id":"0577cb32-1504-4261-b106-8675b26f037c","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"0577cb32-1504-4261-b106-8675b26f037c","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"96d380b7-ecf9-4d13-90f8-ab6bcf282d53":{"role":"reader","value":{"id":"96d380b7-ecf9-4d13-90f8-ab6bcf282d53","version":1,"type":"header","properties":{"title":[["slice的扩容机制"]]},"format":{"copied_from_pointer":{"id":"7149483c-26e6-4844-8078-c25c12f55502","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"7149483c-26e6-4844-8078-c25c12f55502","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"0544a40b-35f9-41b0-a5e1-5b1fdd0fea81":{"role":"reader","value":{"id":"0544a40b-35f9-41b0-a5e1-5b1fdd0fea81","version":1,"type":"sub_header","properties":{"title":[["step 1. 步长"]]},"format":{"copied_from_pointer":{"id":"025b0d83-ec66-47c6-938e-65ca7de8e317","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449316,"last_edited_time":1671179449316,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"025b0d83-ec66-47c6-938e-65ca7de8e317","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"3ff3b7a9-8c5f-43c0-ae15-1afb2e790da7":{"role":"reader","value":{"id":"3ff3b7a9-8c5f-43c0-ae15-1afb2e790da7","version":1,"type":"text","properties":{"title":[["当我们len超过cap的时候就会触发扩容，实际调用的函数是"],["growslice",[["c"]]],["，我们来看看go是怎么实现的"]]},"format":{"copied_from_pointer":{"id":"c52c259b-7482-411f-8bcd-37642f67c379","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"c52c259b-7482-411f-8bcd-37642f67c379","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"3d6d2e5a-9b80-43c5-8fc2-7c9d91e65b05":{"role":"reader","value":{"id":"3d6d2e5a-9b80-43c5-8fc2-7c9d91e65b05","version":1,"type":"code","properties":{"title":[["// growslice handles slice growth during append.\n// It is passed the slice element type, the old slice, and the desired new minimum capacity,\n// and it returns a new slice with at least that capacity, with the old data\n// copied into it.\n// The new slice's length is set to the old slice's length,\n// NOT to the new requested capacity.\n// This is for codegen convenience. The old slice's length is used immediately\n// to calculate where to write new values during an append.\n// TODO: When the old backend is gone, reconsider this decision.\n// The SSA backend might prefer the new length or to return only ptr/cap and save stack space.\nfunc growslice(et *_type, old slice, cap int) slice {\n\t...\n\t\n\tnewcap := old.cap\n\t\tdoublecap := newcap + newcap\n\t\tif cap \u003e doublecap {\n\t\t\tnewcap = cap\n\t\t} else {\n\t\t\tif old.cap \u003c 1024 {\n\t\t\t\tnewcap = doublecap\n\t\t\t} else {\n\t\t\t\t// Check 0 \u003c newcap to detect overflow\n\t\t\t\t// and prevent an infinite loop.\n\t\t\t\tfor 0 \u003c newcap \u0026\u0026 newcap \u003c cap {\n\t\t\t\t\tnewcap += newcap / 4\n\t\t\t\t}\n\t\t\t\t// Set newcap to the requested cap when\n\t\t\t\t// the newcap calculation overflowed.\n\t\t\t\tif newcap \u003c= 0 {\n\t\t\t\t\tnewcap = cap\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t...\n}"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"87b9ced6-68dc-49b9-9513-b4d2eb262045","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"87b9ced6-68dc-49b9-9513-b4d2eb262045","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"91665dd7-7826-4dc6-9173-aebebe417922":{"role":"reader","value":{"id":"91665dd7-7826-4dc6-9173-aebebe417922","version":1,"type":"table","content":["c87f560e-793f-4ff9-90bf-3befb4594c3a","48ea1d88-513b-4be7-a2ba-208a799e86f4","6f5da402-4d21-4869-a132-ea621a54ada9","6225e51f-3b70-44a0-a340-65205638d61e","5f4dd636-ebe2-49ec-8e1f-49f4d844cd31"],"format":{"copied_from_pointer":{"id":"48bbb7e9-7cef-4203-903c-25b3e814e1a5","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"},"table_block_column_order":["Ok{H","HhUs"],"table_block_column_header":true},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"48bbb7e9-7cef-4203-903c-25b3e814e1a5","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"c87f560e-793f-4ff9-90bf-3befb4594c3a":{"role":"reader","value":{"id":"c87f560e-793f-4ff9-90bf-3befb4594c3a","version":1,"type":"table_row","properties":{"HhUs":[["含义"]],"Ok{H":[["变量"]]},"format":{"copied_from_pointer":{"id":"2edc8d32-3010-4e5e-9f9a-c20256020ce6","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"91665dd7-7826-4dc6-9173-aebebe417922","parent_table":"block","alive":true,"copied_from":"2edc8d32-3010-4e5e-9f9a-c20256020ce6","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"48ea1d88-513b-4be7-a2ba-208a799e86f4":{"role":"reader","value":{"id":"48ea1d88-513b-4be7-a2ba-208a799e86f4","version":1,"type":"table_row","properties":{"HhUs":[["期望容量"]],"Ok{H":[["cap"]]},"format":{"copied_from_pointer":{"id":"f421280c-14db-49cc-b9c1-af0c80a3ae1b","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"91665dd7-7826-4dc6-9173-aebebe417922","parent_table":"block","alive":true,"copied_from":"f421280c-14db-49cc-b9c1-af0c80a3ae1b","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"6f5da402-4d21-4869-a132-ea621a54ada9":{"role":"reader","value":{"id":"6f5da402-4d21-4869-a132-ea621a54ada9","version":1,"type":"table_row","properties":{"HhUs":[["当前容量"]],"Ok{H":[["old.cap"]]},"format":{"copied_from_pointer":{"id":"863a808d-97c8-43da-8116-6272b999050c","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"91665dd7-7826-4dc6-9173-aebebe417922","parent_table":"block","alive":true,"copied_from":"863a808d-97c8-43da-8116-6272b999050c","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"6225e51f-3b70-44a0-a340-65205638d61e":{"role":"reader","value":{"id":"6225e51f-3b70-44a0-a340-65205638d61e","version":1,"type":"table_row","properties":{"HhUs":[["当前容量的两倍"]],"Ok{H":[["doublecap"]]},"format":{"copied_from_pointer":{"id":"52a61e72-cb38-4da4-af22-bd8bbcc97f7e","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"91665dd7-7826-4dc6-9173-aebebe417922","parent_table":"block","alive":true,"copied_from":"52a61e72-cb38-4da4-af22-bd8bbcc97f7e","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"5f4dd636-ebe2-49ec-8e1f-49f4d844cd31":{"role":"reader","value":{"id":"5f4dd636-ebe2-49ec-8e1f-49f4d844cd31","version":1,"type":"table_row","properties":{"HhUs":[["最终容量"]],"Ok{H":[["newcap"]]},"format":{"copied_from_pointer":{"id":"ad562d02-465d-42c2-ae32-5c26029f23c9","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"91665dd7-7826-4dc6-9173-aebebe417922","parent_table":"block","alive":true,"copied_from":"ad562d02-465d-42c2-ae32-5c26029f23c9","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"6b141b6e-ce55-4837-b754-1bb577142844":{"role":"reader","value":{"id":"6b141b6e-ce55-4837-b754-1bb577142844","version":1,"type":"text","properties":{"title":[["决策逻辑："]]},"format":{"copied_from_pointer":{"id":"bb427629-5536-44aa-a86e-e84a7aed2754","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"bb427629-5536-44aa-a86e-e84a7aed2754","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"5576d2ca-b7c1-459f-9d39-cde67e3d47cd":{"role":"reader","value":{"id":"5576d2ca-b7c1-459f-9d39-cde67e3d47cd","version":1,"type":"bulleted_list","properties":{"title":[["如果期望容量超过当前容量的两倍，直接设置为期望容量，否则"]]},"format":{"copied_from_pointer":{"id":"21a0e612-ef7e-41a7-90da-4a10ec8b1572","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"21a0e612-ef7e-41a7-90da-4a10ec8b1572","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"9c204879-903a-43d6-a385-0999ba4c425b":{"role":"reader","value":{"id":"9c204879-903a-43d6-a385-0999ba4c425b","version":1,"type":"bulleted_list","properties":{"title":[["如果当前容量的值小于1024，直接翻倍，否则"]]},"format":{"copied_from_pointer":{"id":"440c25b2-4e17-458c-b861-82d3fdada1e7","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"440c25b2-4e17-458c-b861-82d3fdada1e7","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"6a23c330-381a-423d-9f90-ab851485a243":{"role":"reader","value":{"id":"6a23c330-381a-423d-9f90-ab851485a243","version":1,"type":"bulleted_list","properties":{"title":[["如果newcap \u003c cap，不断以1.25倍的速度增长"]]},"format":{"copied_from_pointer":{"id":"3e194dc7-5173-407f-8995-fb332d232f22","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"3e194dc7-5173-407f-8995-fb332d232f22","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"87cb9adb-e52b-4a25-8daa-75edb8b69b64":{"role":"reader","value":{"id":"87cb9adb-e52b-4a25-8daa-75edb8b69b64","version":1,"type":"image","properties":{"size":[["163.3KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b8eced42-e046-4d89-894b-f3331bc1b6e5/Untitled.png"]]},"format":{"block_width":2796,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b8eced42-e046-4d89-894b-f3331bc1b6e5/Untitled.png","block_full_width":false,"block_page_width":true,"block_aspect_ratio":0.26895565092989987,"copied_from_pointer":{"id":"c47133ec-cee1-49c2-8140-bc11ecf2bcfe","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"},"block_preserve_scale":true},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"c47133ec-cee1-49c2-8140-bc11ecf2bcfe","file_ids":["b8eced42-e046-4d89-894b-f3331bc1b6e5"],"created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"dcf43436-53f6-413b-9a4d-5da029a8e0c9":{"role":"reader","value":{"id":"dcf43436-53f6-413b-9a4d-5da029a8e0c9","version":1,"type":"text","format":{"copied_from_pointer":{"id":"2707e1ef-5946-4175-9742-4152c830c798","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"2707e1ef-5946-4175-9742-4152c830c798","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"6afb7cb8-c8e3-4df5-a77c-b4ce981e2da6":{"role":"reader","value":{"id":"6afb7cb8-c8e3-4df5-a77c-b4ce981e2da6","version":1,"type":"text","properties":{"title":[["对于1.25倍扩增速度，go的1.18.1版本作出了优化"]]},"format":{"copied_from_pointer":{"id":"74cf8287-1c47-4945-8723-3389fd8a758d","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"74cf8287-1c47-4945-8723-3389fd8a758d","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"d18fbc5d-c971-467b-8a06-c24f9a70b841":{"role":"reader","value":{"id":"d18fbc5d-c971-467b-8a06-c24f9a70b841","version":1,"type":"code","properties":{"title":[["func growslice(et *_type, old slice, cap int) slice {\n\t...\t\n\tnewcap := old.cap\n\tdoublecap := newcap + newcap\n\tif cap \u003e doublecap {\n\t\t\tnewcap = cap\n\t} else {\n\t\t\tconst threshold = 256\n\t\t\tif old.cap \u003c threshold {\n\t\t\t\t\tnewcap = doublecap\n\t\t\t} else {\n\t\t\t\t\t// Check 0 \u003c newcap to detect overflow\n\t\t\t\t\t// and prevent an infinite loop.\n\t\t\t\t\tfor 0 \u003c newcap \u0026\u0026 newcap \u003c cap {\n\t\t\t\t\t\t\t// Transition from growing 2x for small slices\n\t\t\t\t\t\t\t// to growing 1.25x for large slices. This formula\n\t\t\t\t\t\t\t// gives a smooth-ish transition between the two.\n\t\t\t\t\t\t\tnewcap += (newcap + 3*threshold) / 4\n\t\t\t\t\t}\n\t\t\t\t\t// Set newcap to the requested cap when\n\t\t\t\t\t// the newcap calculation overflowed.\n\t\t\t\t\tif newcap \u003c= 0 {\n\t\t\t\t\t\t\tnewcap = cap\n\t\t\t\t\t}\n\t\t\t}\n\t}\n\t...\n}"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"69807686-ca99-4908-add7-55fdf6d7cb76","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"69807686-ca99-4908-add7-55fdf6d7cb76","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"08f6a449-235d-4ed8-b8af-6abd7625f009":{"role":"reader","value":{"id":"08f6a449-235d-4ed8-b8af-6abd7625f009","version":1,"type":"text","properties":{"title":[["这里的区别就是"],["newcap += (newcap + 3*threshold) / 4",[["c"]]],[" ，注释上说相比于旧版本，这里增长速度更加smooth，具体效果可以用python画图模拟一下，这里就不展开了。\n"]]},"format":{"copied_from_pointer":{"id":"d19a31e1-851f-4751-bbda-4246fb6d3685","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"d19a31e1-851f-4751-bbda-4246fb6d3685","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"ae3a778d-52d7-4d04-9744-e99ce404c9ec":{"role":"reader","value":{"id":"ae3a778d-52d7-4d04-9744-e99ce404c9ec","version":1,"type":"text","properties":{"title":[["下面我们来看一段代码，看看结果是不是和我们上面分析得一样"]]},"format":{"copied_from_pointer":{"id":"aa5fb7ec-c522-47a5-a2fd-ca2774697887","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"aa5fb7ec-c522-47a5-a2fd-ca2774697887","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"2b59c5b6-b00f-416c-9f71-d1d86592a449":{"role":"reader","value":{"id":"2b59c5b6-b00f-416c-9f71-d1d86592a449","version":1,"type":"code","properties":{"title":[["func TestSlice(t *testing.T) {\n\tc := make([]int, 0, 2)\n\t// 此时c满\n\tc = append(c, 1, 2)\n\t// 此时按照计算公式，期望容量为5，当前容量为2，则c的最终容量是5\n\tc = append(c, 3, 4, 5)\n\t// 猜测为5 5\n\tfmt.Println(len(c), cap(c))\n}"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"1fb7b43b-185c-46dd-a108-8e166f714aad","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"1fb7b43b-185c-46dd-a108-8e166f714aad","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"9fe6c4dd-9648-42b6-801a-79234485dc1d":{"role":"reader","value":{"id":"9fe6c4dd-9648-42b6-801a-79234485dc1d","version":1,"type":"text","properties":{"title":[["但是输出结果是"],["5 6",[["c"]]],["，cap被设置成了6，这是为什么呢？原因是go还会进行内存对齐"]]},"format":{"copied_from_pointer":{"id":"9526dd2e-11d0-498d-b500-447f9203c354","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"9526dd2e-11d0-498d-b500-447f9203c354","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"1d520e60-088a-4381-9603-3605ea112e4b":{"role":"reader","value":{"id":"1d520e60-088a-4381-9603-3605ea112e4b","version":1,"type":"sub_header","properties":{"title":[["step 2. 内存对齐"]]},"format":{"copied_from_pointer":{"id":"d52828d1-1257-4c89-b2be-f839a0cdb5b4","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"d52828d1-1257-4c89-b2be-f839a0cdb5b4","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"1d3bb36d-7488-4c5d-963e-b2c33b83174c":{"role":"reader","value":{"id":"1d3bb36d-7488-4c5d-963e-b2c33b83174c","version":1,"type":"code","properties":{"title":[["func growslice(et *_type, old slice, cap int) slice {\n\t...\n\n\tnewcap := old.cap\n\tdoublecap := newcap + newcap\n\tif cap \u003e doublecap {\n\t\tnewcap = cap\n\t} else {\n\t\tif old.cap \u003c 1024 {\n\t\t\tnewcap = doublecap\n\t\t} else {\n\t\t\t// Check 0 \u003c newcap to detect overflow\n\t\t\t// and prevent an infinite loop.\n\t\t\tfor 0 \u003c newcap \u0026\u0026 newcap \u003c cap {\n\t\t\t\tnewcap += newcap / 4\n\t\t\t}\n\t\t\t// Set newcap to the requested cap when\n\t\t\t// the newcap calculation overflowed.\n\t\t\tif newcap \u003c= 0 {\n\t\t\t\tnewcap = cap\n\t\t\t}\n\t\t}\n\t}\n\n\tvar overflow bool\n\tvar lenmem, newlenmem, capmem uintptr\n\t// Specialize for common values of et.size.\n\t// For 1 we don't need any division/multiplication.\n\t// For sys.PtrSize, compiler will optimize division/multiplication into a shift by a constant.\n\t// For powers of 2, use a variable shift.\n\tswitch {\n\tcase et.size == 1:\n\t\t...\n\tcase et.size == sys.PtrSize:\n\t\t...\n\tcase isPowerOfTwo(et.size):\n\t\tvar shift uintptr\n\t\tif sys.PtrSize == 8 {\n\t\t\t// Mask shift for better code generation.\n\t\t\tshift = uintptr(sys.Ctz64(uint64(et.size))) \u0026 63\n\t\t} else {\n\t\t\tshift = uintptr(sys.Ctz32(uint32(et.size))) \u0026 31\n\t\t}\n\t\tlenmem = uintptr(old.len) \u003c\u003c shift\n\t\tnewlenmem = uintptr(cap) \u003c\u003c shift\n\t\tcapmem = roundupsize(uintptr(newcap) \u003c\u003c shift)\n\t\toverflow = uintptr(newcap) \u003e (maxAlloc \u003e\u003e shift)\n\t\tnewcap = int(capmem \u003e\u003e shift)\n\tdefault:\n\t\t...\n\t}\n\t...\n\n\treturn slice{p, old.len, newcap}\n}"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"ed5bf066-b1ab-483a-89da-df6310affd98","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"ed5bf066-b1ab-483a-89da-df6310affd98","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"4ee3bdc0-4a58-4bcb-924d-9c8529d6920d":{"role":"reader","value":{"id":"4ee3bdc0-4a58-4bcb-924d-9c8529d6920d","version":1,"type":"text","properties":{"title":[["et.size指的是存储元素类型的大小，这里int类型字节是8，使用下面的函数判断通过"]]},"format":{"copied_from_pointer":{"id":"3cb19bdc-c0f3-438d-9bca-5b29a6e72acc","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"3cb19bdc-c0f3-438d-9bca-5b29a6e72acc","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"c81c9ac2-31b1-4699-8414-8b93d8444ea9":{"role":"reader","value":{"id":"c81c9ac2-31b1-4699-8414-8b93d8444ea9","version":1,"type":"code","properties":{"title":[["func isPowerOfTwo(x uintptr) bool {\n\treturn x\u0026(x-1) == 0\n}"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"5f0cbc74-54e0-4f52-a868-f50fc3c01e7f","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"5f0cbc74-54e0-4f52-a868-f50fc3c01e7f","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"1c4689cf-e01d-4d2e-8723-a763730600af":{"role":"reader","value":{"id":"1c4689cf-e01d-4d2e-8723-a763730600af","version":1,"type":"text","properties":{"title":[["先不看代码，我们分析一下怎么内存对齐："]]},"format":{"copied_from_pointer":{"id":"ed3976ce-309a-430a-9af8-624bd3471f59","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"ed3976ce-309a-430a-9af8-624bd3471f59","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"cc5a9467-0ea4-4437-99fc-764ca742730a":{"role":"reader","value":{"id":"cc5a9467-0ea4-4437-99fc-764ca742730a","version":1,"type":"text","properties":{"title":[["我们的slice现在存储了5个元素，int类型8个字节，则新的存储容量大小"],["newcap = 5 * 8 = 40",[["c"]]],["，但是为了更好的内存分配减少碎片，go使用了和c一样的内存对齐策略，使用"],["roundupsize",[["c"]]],[" 向上调整大小，这里调整成了48，那么最终的"],["cap = 48 / 8 = 6",[["c"]]],["，所以在上面的例子cap被设置为了6"]]},"format":{"copied_from_pointer":{"id":"27dbee5f-a7aa-4077-ae2c-d03a4a07c673","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"27dbee5f-a7aa-4077-ae2c-d03a4a07c673","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"d81f5fc7-1ef0-4fc0-a1ec-7c2e84ca0509":{"role":"reader","value":{"id":"d81f5fc7-1ef0-4fc0-a1ec-7c2e84ca0509","version":1,"type":"text","properties":{"title":[["为什么被调整到48呢？",[["b"]]]]},"format":{"copied_from_pointer":{"id":"1f35b428-9ddc-4c9b-81be-c0283ff9761d","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"1f35b428-9ddc-4c9b-81be-c0283ff9761d","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"c5883278-3f08-4137-8fba-00e27e1040f7":{"role":"reader","value":{"id":"c5883278-3f08-4137-8fba-00e27e1040f7","version":1,"type":"text","properties":{"title":[["原因是Go语言的内存管理通常把这些内存块都预先申请好，并且被分为常用的规格，比如8，16， 32， 48， 64等，当我们申请40 bytes的时候，会申请一个足够大的内存块给我们，这就返回的是48 bytes"]]},"format":{"copied_from_pointer":{"id":"31fd03f1-f9c2-4eb2-9327-10197ead98c7","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"31fd03f1-f9c2-4eb2-9327-10197ead98c7","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"9354acb8-e7cb-4e3c-b912-ed480592071a":{"role":"reader","value":{"id":"9354acb8-e7cb-4e3c-b912-ed480592071a","version":1,"type":"text","properties":{"title":[["至于怎么设置的呢，这里有两个很巧妙的函数 "],["Ctz64",[["c"]]],[" 和 "],["roundupsize",[["c"]]]]},"format":{"copied_from_pointer":{"id":"0c3bb585-3eef-40cf-a21c-3e1e020fc3f4","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"0c3bb585-3eef-40cf-a21c-3e1e020fc3f4","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"b3ad5d1e-3d30-4248-bd95-6d8751a07a28":{"role":"reader","value":{"id":"b3ad5d1e-3d30-4248-bd95-6d8751a07a28","version":1,"type":"code","properties":{"title":[["// Ctz64 counts trailing (low-order) zeroes,\n// and if all are zero, then 64.\n// 返回x中末尾0的个数\nfunc Ctz64(x uint64) int {\n\tx \u0026= -x                       // isolate low-order bit\n\ty := x * deBruijn64ctz \u003e\u003e 58  // extract part of deBruijn sequence\n\ti := int(deBruijnIdx64ctz[y]) // convert to bit index\n\tz := int((x - 1) \u003e\u003e 57 \u0026 64)  // adjustment if zero\n\treturn i + z\n}\n\nfunc roundupsize(size uintptr) uintptr {\n\tif size \u003c _MaxSmallSize {\n\t\tif size \u003c= smallSizeMax-8 {\n\t\t\treturn uintptr(class_to_size[size_to_class8[divRoundUp(size, smallSizeDiv)]])\n\t\t} else {\n\t\t\treturn uintptr(class_to_size[size_to_class128[divRoundUp(size-smallSizeMax, largeSizeDiv)]])\n\t\t}\n\t}\n\tif size+_PageSize \u003c size {\n\t\treturn size\n\t}\n\treturn alignUp(size, _PageSize)\n}\n\n// alignUp rounds n up to a multiple of a. a must be a power of 2.\nfunc alignUp(n, a uintptr) uintptr {\n\treturn (n + a - 1) \u0026^ (a - 1)\n}\n// \u0026^ 是 ANT NOT 运算符"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"358c7db0-616a-4c7b-88e6-1061c8de2787","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"358c7db0-616a-4c7b-88e6-1061c8de2787","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"c1342679-8037-4d3b-8393-1449ae8c9bf8":{"role":"reader","value":{"id":"c1342679-8037-4d3b-8393-1449ae8c9bf8","version":1,"type":"text","properties":{"title":[["然后我们再看这一块代码"]]},"format":{"copied_from_pointer":{"id":"71f22d56-f657-4fca-9302-36b68f3035e9","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"71f22d56-f657-4fca-9302-36b68f3035e9","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"8a86710c-c0bc-4fc8-8e20-02da04f2a267":{"role":"reader","value":{"id":"8a86710c-c0bc-4fc8-8e20-02da04f2a267","version":1,"type":"code","properties":{"title":[["\tcase isPowerOfTwo(et.size):\n\t\tvar shift uintptr\n\t\tif sys.PtrSize == 8 {\n\t\t\t// Mask shift for better code generation.\n\t\t\tshift = uintptr(sys.Ctz64(uint64(et.size))) \u0026 63\n\t\t} else {\n\t\t\tshift = uintptr(sys.Ctz32(uint32(et.size))) \u0026 31\n\t\t}\n\t\tcapmem = roundupsize(uintptr(newcap) \u003c\u003c shift)\n\t\tnewcap = int(capmem \u003e\u003e shift)"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"7b8eecd5-69c7-45d5-b2e0-6fee1266a5ad","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"7b8eecd5-69c7-45d5-b2e0-6fee1266a5ad","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"8926da40-cd3f-4a10-985c-182093f6442e":{"role":"reader","value":{"id":"8926da40-cd3f-4a10-985c-182093f6442e","version":1,"type":"text","properties":{"title":[["首先我们通过"],["Ctz64(et.size)",[["c"]]],[" 得到shift的值，int类型是8个字节，则8的二进制末尾有3个0，我们得到"],["shift=3",[["c"]]]]},"format":{"copied_from_pointer":{"id":"70f706d8-01f0-4eda-9280-b4344197685a","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"70f706d8-01f0-4eda-9280-b4344197685a","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"51080fc4-ba10-41ff-8d38-ef97f182da16":{"role":"reader","value":{"id":"51080fc4-ba10-41ff-8d38-ef97f182da16","version":1,"type":"text","properties":{"title":[["然后"],["newcap\u003c\u003cshift",[["c"]]],[" 就是 "],["5 \u003c\u003c 3",[["c"]]],[" 得到40"]]},"format":{"copied_from_pointer":{"id":"87a381f3-1aae-42f7-8784-d090e911e095","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"87a381f3-1aae-42f7-8784-d090e911e095","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"7b5963cc-6986-4eb3-950c-6c036d81d96b":{"role":"reader","value":{"id":"7b5963cc-6986-4eb3-950c-6c036d81d96b","version":1,"type":"text","properties":{"title":[["经过"],["roundupsize",[["c"]]],["，得到"],["capmem = 48",[["c"]]]]},"format":{"copied_from_pointer":{"id":"9b110d56-197a-40c7-ba06-5ce3535cdc5e","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"9b110d56-197a-40c7-ba06-5ce3535cdc5e","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"f7dc82a4-09f5-475b-bccf-bb8507df2309":{"role":"reader","value":{"id":"f7dc82a4-09f5-475b-bccf-bb8507df2309","version":1,"type":"text","properties":{"title":[["最终再还原回来 "],["newcap = int(48 \u003e\u003e 3) = 6",[["c"]]]]},"format":{"copied_from_pointer":{"id":"5bf98707-f145-44dd-b5c3-30b0886d2ab8","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"5bf98707-f145-44dd-b5c3-30b0886d2ab8","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"cc448335-8a98-45e4-8da9-efd9067e1d3c":{"role":"reader","value":{"id":"cc448335-8a98-45e4-8da9-efd9067e1d3c","version":1,"type":"text","properties":{"title":[["这样就能内存对齐啦"]]},"format":{"copied_from_pointer":{"id":"461d735a-847b-43ec-bdf4-951e7e4f5f4f","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"461d735a-847b-43ec-bdf4-951e7e4f5f4f","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"b8ea8a74-3b75-47b9-afe3-7016e9d02d7b":{"role":"reader","value":{"id":"b8ea8a74-3b75-47b9-afe3-7016e9d02d7b","version":1,"type":"sub_header","properties":{"title":[["总结"]]},"format":{"copied_from_pointer":{"id":"b8c14434-cf35-44df-af77-caad59eeb242","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"b8c14434-cf35-44df-af77-caad59eeb242","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"6b1d36fc-c9de-4b9f-863b-08968543a079":{"role":"reader","value":{"id":"6b1d36fc-c9de-4b9f-863b-08968543a079","version":1,"type":"text","properties":{"title":[["slice的扩容步骤有两步"]]},"format":{"copied_from_pointer":{"id":"0c99766c-4910-40bb-9bc5-59670651e3e3","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"0c99766c-4910-40bb-9bc5-59670651e3e3","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"4af00b0d-ecc7-40e4-ae0b-0188bb303f74":{"role":"reader","value":{"id":"4af00b0d-ecc7-40e4-ae0b-0188bb303f74","version":1,"type":"numbered_list","properties":{"title":[["调整期望容量"]]},"content":["cbbb80e1-aff4-4a51-9163-ad1f52367f4d","767626d6-e481-4c4b-b97d-a7709740ffe9","5fceac48-8361-4698-9c19-a96aece03810"],"format":{"copied_from_pointer":{"id":"a7ccb892-d0c5-49b0-99b4-932070417ec7","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"a7ccb892-d0c5-49b0-99b4-932070417ec7","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"cbbb80e1-aff4-4a51-9163-ad1f52367f4d":{"role":"reader","value":{"id":"cbbb80e1-aff4-4a51-9163-ad1f52367f4d","version":1,"type":"numbered_list","properties":{"title":[["如果期望容量是当前容量的两倍，直接更新，否则"]]},"format":{"copied_from_pointer":{"id":"f94175d2-7de9-477a-ae84-e09f2799913e","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"4af00b0d-ecc7-40e4-ae0b-0188bb303f74","parent_table":"block","alive":true,"copied_from":"f94175d2-7de9-477a-ae84-e09f2799913e","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"767626d6-e481-4c4b-b97d-a7709740ffe9":{"role":"reader","value":{"id":"767626d6-e481-4c4b-b97d-a7709740ffe9","version":1,"type":"numbered_list","properties":{"title":[["如果小于1024，直接翻倍当前容量，否则"]]},"format":{"copied_from_pointer":{"id":"494d5db1-f6d3-417c-9434-c0c9b4bf22c9","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"4af00b0d-ecc7-40e4-ae0b-0188bb303f74","parent_table":"block","alive":true,"copied_from":"494d5db1-f6d3-417c-9434-c0c9b4bf22c9","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"5fceac48-8361-4698-9c19-a96aece03810":{"role":"reader","value":{"id":"5fceac48-8361-4698-9c19-a96aece03810","version":1,"type":"numbered_list","properties":{"title":[["当前容量按照1.25的速度增长，直到超过期望容量"]]},"format":{"copied_from_pointer":{"id":"7cc654cb-7ea3-4812-b73b-5fd5df139c03","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"4af00b0d-ecc7-40e4-ae0b-0188bb303f74","parent_table":"block","alive":true,"copied_from":"7cc654cb-7ea3-4812-b73b-5fd5df139c03","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"8c5c7f0f-9057-4973-a38f-57cabfd20b1e":{"role":"reader","value":{"id":"8c5c7f0f-9057-4973-a38f-57cabfd20b1e","version":1,"type":"numbered_list","properties":{"title":[["进行内存对齐，向上调整到最接近的2的n次幂"]]},"format":{"copied_from_pointer":{"id":"c2d6abc5-1cda-4792-8883-5df6ccb5f957","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"c2d6abc5-1cda-4792-8883-5df6ccb5f957","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"140a6d0f-5400-4b3c-aa47-abd1c65f52ad":{"role":"reader","value":{"id":"140a6d0f-5400-4b3c-aa47-abd1c65f52ad","version":1,"type":"header","properties":{"title":[["slice的拷贝"]]},"format":{"copied_from_pointer":{"id":"134a78a0-5256-43c6-bfd2-fadc60474fc5","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"134a78a0-5256-43c6-bfd2-fadc60474fc5","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"94d43a12-4e12-44d8-ac21-b03c270b05f7":{"role":"reader","value":{"id":"94d43a12-4e12-44d8-ac21-b03c270b05f7","version":1,"type":"text","properties":{"title":[["切片拷贝的方法是slicecopy，我们看看是怎么做的："]]},"format":{"copied_from_pointer":{"id":"a1fa6d99-34b4-4435-978a-20ff22436888","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"a1fa6d99-34b4-4435-978a-20ff22436888","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"1b7bbb7f-d6ff-4eb0-a86f-12dbd385ae21":{"role":"reader","value":{"id":"1b7bbb7f-d6ff-4eb0-a86f-12dbd385ae21","version":1,"type":"code","properties":{"title":[["// slicecopy is used to copy from a string or slice of pointerless elements into a slice.\nfunc slicecopy(toPtr unsafe.Pointer, toLen int, fromPtr unsafe.Pointer, fromLen int, width uintptr) int {\n\t// 如果有一个长度为0，提前退出\n\tif fromLen == 0 || toLen == 0 {\n\t\treturn 0\n\t}\n\t\n\t// 记录下较短的长度\n\tn := fromLen\n\tif toLen \u003c n {\n\t\tn = toLen\n\t}\n\t// 如果指定的长度为0，那么提前退出\n\tif width == 0 {\n\t\treturn n\n\t}\n\n\tsize := uintptr(n) * width\n\t...\n\n\tif size == 1 { // common case worth about 2x to do here\n\t\t// TODO: is this still worth it with new memmove impl?\n\n\t\t// 如果只有一个长度，直接指针转换即可\n\t\t*(*byte)(toPtr) = *(*byte)(fromPtr) // known to be a byte pointer\n\t} else {\n\t\t// 从from.array 移动 size 个 bytes 拷贝到 to.array\n\t\tmemmove(toPtr, fromPtr, size)\n\t}\n\treturn n\n}"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"e34b2b11-9b66-4eec-a5da-5582eba13f04","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"e34b2b11-9b66-4eec-a5da-5582eba13f04","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"e9bf6c44-b3df-40bb-8853-35598a46e9fb":{"role":"reader","value":{"id":"e9bf6c44-b3df-40bb-8853-35598a46e9fb","version":1,"type":"text","properties":{"title":[["执行看看效果"]]},"format":{"copied_from_pointer":{"id":"af449430-5c34-4274-9cbf-cdd0ac49a746","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"af449430-5c34-4274-9cbf-cdd0ac49a746","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"b74ad982-9f2a-440f-9414-0c759437916e":{"role":"reader","value":{"id":"b74ad982-9f2a-440f-9414-0c759437916e","version":1,"type":"code","properties":{"title":[["func TestCopy(t *testing.T) {\n\ta := []int{1, 2, 3}\n\tb := make([]int, 5)\n\tc := make([]int, 2)\n\tn := copy(b, a)\n\tfmt.Println(b, n)\n\tn = copy(c, a)\n\tfmt.Println(c, n)\n}\n\n// === RUN   TestCopy\n// [1 2 3 0 0] 3\n// [1 2] 2\n// --- PASS: TestCopy (0.00s)"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"91df9e38-5509-424c-b84e-7e6bbe11f631","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"91df9e38-5509-424c-b84e-7e6bbe11f631","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"1b0c90c1-f9d5-47ba-8cea-e8e57c874be5":{"role":"reader","value":{"id":"1b0c90c1-f9d5-47ba-8cea-e8e57c874be5","version":1,"type":"sub_header","properties":{"title":[["slice遍历的坑"]]},"format":{"copied_from_pointer":{"id":"1aa01744-a970-4f11-8442-1154a40128a9","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"1aa01744-a970-4f11-8442-1154a40128a9","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"c2e5bb09-c3ac-4847-9e6b-1bd743842807":{"role":"reader","value":{"id":"c2e5bb09-c3ac-4847-9e6b-1bd743842807","version":1,"type":"text","properties":{"title":[["但是我们拷贝有一个需要注意的地方："]]},"format":{"copied_from_pointer":{"id":"f046769a-ede5-4cf8-b0da-b73ade4b51bb","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"f046769a-ede5-4cf8-b0da-b73ade4b51bb","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"95f0f27e-986a-4ae7-931d-ef4a94cfc84f":{"role":"reader","value":{"id":"95f0f27e-986a-4ae7-931d-ef4a94cfc84f","version":1,"type":"code","properties":{"title":[["func TestFor(t *testing.T) {\n\tslice := []int{10, 20, 30, 40}\n\tfor index, value := range slice {\n\t\tfmt.Printf(\"value = %d , value-addr = %x , slice-addr = %x\\n\", value, \u0026value, \u0026slice[index])\n\t}\n}"]],"language":[["Go"]]},"format":{"code_wrap":true,"copied_from_pointer":{"id":"ae8f0880-3136-41f2-a082-94a6551d16b7","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"ae8f0880-3136-41f2-a082-94a6551d16b7","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"afaa2b88-9724-4eda-a545-d7dc3edc10c6":{"role":"reader","value":{"id":"afaa2b88-9724-4eda-a545-d7dc3edc10c6","version":1,"type":"text","properties":{"title":[["输出："]]},"format":{"copied_from_pointer":{"id":"c2cf8046-0181-4d62-b851-314a529223d2","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"c2cf8046-0181-4d62-b851-314a529223d2","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"60f73379-bd8e-4990-88d2-696313bc3b97":{"role":"reader","value":{"id":"60f73379-bd8e-4990-88d2-696313bc3b97","version":1,"type":"code","properties":{"title":[["=== RUN   TestFor\nvalue = 10 , value-addr = 1400001e250 , slice-addr = 1400001a0a0\nvalue = 20 , value-addr = 1400001e250 , slice-addr = 1400001a0a8\nvalue = 30 , value-addr = 1400001e250 , slice-addr = 1400001a0b0\nvalue = 40 , value-addr = 1400001e250 , slice-addr = 1400001a0b8\n--- PASS: TestFor (0.00s)"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"3c4f4f8d-cf49-462f-9950-2b89b7e3de64","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"3c4f4f8d-cf49-462f-9950-2b89b7e3de64","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"a268f40a-2028-4b86-bdca-0dff0ffccc83":{"role":"reader","value":{"id":"a268f40a-2028-4b86-bdca-0dff0ffccc83","version":1,"type":"text","properties":{"title":[["可以看到，我们用range去遍历切片的时候，拿到的value其实是切片里面的"],["值拷贝",[["b"]]],["，所以每次Value的地址都不变。因此我们需要用"],["\u0026slice[index]",[["c"]]],["才能拿到真实的地址"]]},"format":{"copied_from_pointer":{"id":"8c3c5697-a93d-4db8-95b3-75f00a07ccb6","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"8c3c5697-a93d-4db8-95b3-75f00a07ccb6","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"1d6ec7d1-7d9a-4e97-bf68-fa41b4982844":{"role":"reader","value":{"id":"1d6ec7d1-7d9a-4e97-bf68-fa41b4982844","version":1,"type":"image","properties":{"size":[["138.4KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/07b1c3a3-a71d-49ab-af2d-f7b440c6c984/Untitled.png"]]},"format":{"block_width":1674,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/07b1c3a3-a71d-49ab-af2d-f7b440c6c984/Untitled.png","block_full_width":false,"block_page_width":true,"block_aspect_ratio":0.7449223416965353,"copied_from_pointer":{"id":"7a67d633-33aa-422e-a258-b7fe466a8154","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"},"block_preserve_scale":true},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"7a67d633-33aa-422e-a258-b7fe466a8154","file_ids":["07b1c3a3-a71d-49ab-af2d-f7b440c6c984"],"created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"e7b42623-807b-4efe-a632-dd74b2dfa3af":{"role":"reader","value":{"id":"e7b42623-807b-4efe-a632-dd74b2dfa3af","version":1,"type":"text","properties":{"title":[["ref: "],["深入解析 Go 中 Slice 底层实现 (halfrost.com)",[["a","https://halfrost.com/go_slice/"]]]]},"format":{"copied_from_pointer":{"id":"9fe48194-677b-4bf9-b2bf-0f28e64fbdc7","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"9fe48194-677b-4bf9-b2bf-0f28e64fbdc7","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"552b3b9e-1512-4057-ae02-d0c5c88c0065":{"role":"reader","value":{"id":"552b3b9e-1512-4057-ae02-d0c5c88c0065","version":1,"type":"text","properties":{"title":[["如果不注意到这点的话，会带来什么问题呢？当我们拷贝的时候可能就会踩坑了："]]},"format":{"copied_from_pointer":{"id":"1b34644a-c339-4beb-9d91-f77135a3ba88","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"1b34644a-c339-4beb-9d91-f77135a3ba88","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"751e2e38-d07f-42c5-b2d8-6266ad83ecc2":{"role":"reader","value":{"id":"751e2e38-d07f-42c5-b2d8-6266ad83ecc2","version":1,"type":"code","properties":{"title":[["func TestFor(t *testing.T) {\n\tslice := []int{10, 20, 30, 40}\n\tto := make([]*int, 0, len(slice))\n\tfor _, value := range slice {\n\t\tto = append(to, \u0026value)\n\t}\n\tfor _, value := range to {\n\t\tfmt.Println(*value, value)\n\t}\n}"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"4807b77e-2706-46cc-9a07-6492ba5fc8fb","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"4807b77e-2706-46cc-9a07-6492ba5fc8fb","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"64da06b3-0345-48a3-bc8b-e0d94d666d34":{"role":"reader","value":{"id":"64da06b3-0345-48a3-bc8b-e0d94d666d34","version":1,"type":"text","properties":{"title":[["输出："]]},"format":{"copied_from_pointer":{"id":"8732076f-8191-4655-bdd7-65b180058d70","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"8732076f-8191-4655-bdd7-65b180058d70","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"9d2b2a3d-5dee-4175-94ce-d47ff598a6d9":{"role":"reader","value":{"id":"9d2b2a3d-5dee-4175-94ce-d47ff598a6d9","version":1,"type":"code","properties":{"title":[["=== RUN   TestFor\n40 0x14000098168\n40 0x14000098168\n40 0x14000098168\n40 0x14000098168\n--- PASS: TestFor (0.00s)"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"9add7150-c6b6-48d3-8773-9572120fb63b","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"9add7150-c6b6-48d3-8773-9572120fb63b","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"18e2c75d-adc4-4240-8916-bef5faca7341":{"role":"reader","value":{"id":"18e2c75d-adc4-4240-8916-bef5faca7341","version":1,"type":"text","properties":{"title":[["可以发现，每次append到to里面的地址都是创建的临时变量value，而value最后的值是40，所以导致最后输出值都是40，且指向的地址就是value的地址。"]]},"format":{"copied_from_pointer":{"id":"cc274ebe-cb6d-4847-a333-7a8161585393","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"cc274ebe-cb6d-4847-a333-7a8161585393","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"b8c22ae9-5b26-4b51-9f66-56c97b85cd71":{"role":"reader","value":{"id":"b8c22ae9-5b26-4b51-9f66-56c97b85cd71","version":1,"type":"text","properties":{"title":[["要避免这个坑，我们要记住for遍历的时候会创建临时变量，避免直接对临时变量操作。"]]},"format":{"copied_from_pointer":{"id":"76334485-01f8-4a87-af1f-bbb4185451df","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"76334485-01f8-4a87-af1f-bbb4185451df","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"732eff97-3199-4002-a488-1528000b25f4":{"role":"reader","value":{"id":"732eff97-3199-4002-a488-1528000b25f4","version":1,"type":"code","properties":{"title":[["// 方法一，直接操作slice的值\nfor index, _ := range slice {\n\t\tto = append(to, \u0026slice[index])\n}\n\n// 方法二，创建临时变量\nfor _, value := range slice {\n\t\ttmp := value\n\t\tto = append(to, \u0026tmp)\n}"]],"language":[["Go"]]},"format":{"copied_from_pointer":{"id":"1542ebb2-c6d9-44aa-ad8d-74529504848a","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"1542ebb2-c6d9-44aa-ad8d-74529504848a","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"867c81b0-f9ac-41e2-9617-ac99ea63c4c5":{"role":"reader","value":{"id":"867c81b0-f9ac-41e2-9617-ac99ea63c4c5","version":1,"type":"text","format":{"copied_from_pointer":{"id":"c0c760e4-2562-422e-9982-c79caf1abb29","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"c0c760e4-2562-422e-9982-c79caf1abb29","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"4b2034c1-8395-4853-b014-953d8d61528e":{"role":"reader","value":{"id":"4b2034c1-8395-4853-b014-953d8d61528e","version":1,"type":"header","properties":{"title":[["一些问题"]]},"format":{"copied_from_pointer":{"id":"1342f443-8c8d-41cd-9e9e-93a0ccaa5667","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"1342f443-8c8d-41cd-9e9e-93a0ccaa5667","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"6a1099bc-de72-4398-837d-79a59cb1152d":{"role":"reader","value":{"id":"6a1099bc-de72-4398-837d-79a59cb1152d","version":1,"type":"bulleted_list","properties":{"title":[["为什么1024之后的扩展速度变为1.25倍呢？"]]},"format":{"copied_from_pointer":{"id":"9de25fdd-9967-4bd3-9fb4-eb57a4334608","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"9de25fdd-9967-4bd3-9fb4-eb57a4334608","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"0d770c11-df91-4472-969a-b9bc2171893e":{"role":"reader","value":{"id":"0d770c11-df91-4472-969a-b9bc2171893e","version":1,"type":"text","properties":{"title":[["因为内存空间很宝贵，底层的数组是在内存中连续的空间，申请这样大规模连续的空间是很昂贵的，1024之后我们用1.25的速度扩展已经足够大了，这样相比于翻倍扩展能解决更多的空间"]]},"format":{"copied_from_pointer":{"id":"30c45ff5-c386-4285-8938-963d17afce4e","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"30c45ff5-c386-4285-8938-963d17afce4e","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"57056f1c-aeed-4253-a0b3-f96f75d42790":{"role":"reader","value":{"id":"57056f1c-aeed-4253-a0b3-f96f75d42790","version":1,"type":"bulleted_list","properties":{"title":[["为什么要内存对齐？"]]},"format":{"copied_from_pointer":{"id":"516c2057-f891-40cd-9af7-ab01a16516c8","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"516c2057-f891-40cd-9af7-ab01a16516c8","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"0153dc81-cf6a-4e07-b02f-5029049a3b2d":{"role":"reader","value":{"id":"0153dc81-cf6a-4e07-b02f-5029049a3b2d","version":1,"type":"text","properties":{"title":[["因为内存管理会预先申请内存后再进行分配，预先申请的大小都是常用的规格，比如说8，16，32，48，64等，因此我们需要进行内存对齐来返回一个足够大的内存块使用。这样避免任意大小的内存块产生内存碎片，影响空间申请和整理。"]]},"format":{"copied_from_pointer":{"id":"b2047ea3-d639-4300-b9b9-6005894738a8","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449320,"last_edited_time":1671179449320,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"b2047ea3-d639-4300-b9b9-6005894738a8","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"757d0ca7-c7a2-4bfd-a450-57a9bf0282f0":{"role":"reader","value":{"id":"757d0ca7-c7a2-4bfd-a450-57a9bf0282f0","version":1,"type":"header","properties":{"title":[["总结"]]},"format":{"copied_from_pointer":{"id":"137285de-e426-42fc-9fe0-5156899476f7","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"137285de-e426-42fc-9fe0-5156899476f7","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"1f83c654-8503-4579-beb1-9f4e60b509c8":{"role":"reader","value":{"id":"1f83c654-8503-4579-beb1-9f4e60b509c8","version":1,"type":"text","properties":{"title":[["简单介绍了一下slice的代码，短小精悍，主要有初始化、扩容、拷贝三种操作。"]]},"format":{"copied_from_pointer":{"id":"efe1a331-bfea-4da0-aa55-3970ae04e610","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449321,"last_edited_time":1671179449321,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"efe1a331-bfea-4da0-aa55-3970ae04e610","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"3cb61869-eaa6-4071-8349-e0a5e3b767e8":{"role":"reader","value":{"id":"3cb61869-eaa6-4071-8349-e0a5e3b767e8","version":1,"type":"text","properties":{"title":[["日常使用的时候，我们最好指定cap的上限，避免扩容带来的开销。同时避免切片遍历的坑。"]]},"format":{"copied_from_pointer":{"id":"8d4278e2-f421-4ba6-aea2-cf32eb8bb3df","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"8d4278e2-f421-4ba6-aea2-cf32eb8bb3df","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"e9f2d460-1ba5-407a-9ac1-07f59828d6e8":{"role":"reader","value":{"id":"e9f2d460-1ba5-407a-9ac1-07f59828d6e8","version":1,"type":"header","properties":{"title":[["Ref"]]},"format":{"copied_from_pointer":{"id":"837a1ac1-d40f-4bb6-be56-9b0a0c474503","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"837a1ac1-d40f-4bb6-be56-9b0a0c474503","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"e898e6fc-2719-4768-8485-54f709455f1f":{"role":"reader","value":{"id":"e898e6fc-2719-4768-8485-54f709455f1f","version":1,"type":"text","properties":{"title":[["浅谈 Go 1.18.1的切片扩容机制 - Lookcos 的网络日志",[["a","https://www.lookcos.cn/archives/1204.html"]]]]},"format":{"copied_from_pointer":{"id":"16aa32c8-54a4-44eb-9470-c7ebd4978bdc","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"16aa32c8-54a4-44eb-9470-c7ebd4978bdc","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"ed0dee31-697e-4624-927d-bae5d18df021":{"role":"reader","value":{"id":"ed0dee31-697e-4624-927d-bae5d18df021","version":1,"type":"text","properties":{"title":[["深入解析 Go 中 Slice 底层实现 (halfrost.com)",[["a","https://halfrost.com/go_slice/"]]]]},"format":{"copied_from_pointer":{"id":"9a40afd9-3c97-4d5f-8c58-6d8aec1c6df8","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"9a40afd9-3c97-4d5f-8c58-6d8aec1c6df8","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"137d2d19-8a1b-43ac-ba37-0b4dd8a39568":{"role":"reader","value":{"id":"137d2d19-8a1b-43ac-ba37-0b4dd8a39568","version":1,"type":"text","properties":{"title":[["slice · 深入解析Go (gitbooks.io)",[["a","https://tiancaiamao.gitbooks.io/go-internals/content/zh/02.2.html"]]]]},"format":{"copied_from_pointer":{"id":"5037bfc1-6f13-4aff-9b5d-5051cdadaba3","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"5037bfc1-6f13-4aff-9b5d-5051cdadaba3","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"75fe0674-fd25-49d6-a601-d6fad808de90":{"role":"reader","value":{"id":"75fe0674-fd25-49d6-a601-d6fad808de90","version":1,"type":"text","properties":{"title":[["golang slice扩容机制 (lifegoeson.cn)",[["a","http://lifegoeson.cn/2022/01/22/golang%20slice%E6%89%A9%E5%AE%B9%E6%9C%BA%E5%88%B6/"]]]]},"format":{"copied_from_pointer":{"id":"710daca5-a0e8-42ab-b0d6-ee0d28418730","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449319,"last_edited_time":1671179449319,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"710daca5-a0e8-42ab-b0d6-ee0d28418730","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"7c4ea007-6f19-4c1d-95f2-5ba833253d73":{"role":"reader","value":{"id":"7c4ea007-6f19-4c1d-95f2-5ba833253d73","version":1,"type":"text","properties":{"title":[["1.5 在 Go 中恰到好处的内存对齐 - 跟煎鱼学 Go (gitbook.io)",[["a","https://eddycjy.gitbook.io/golang/di-1-ke-za-tan/go-memory-align"]]]]},"format":{"copied_from_pointer":{"id":"132b9649-cb62-4ef6-954d-53565900f381","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449317,"last_edited_time":1671179449317,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"132b9649-cb62-4ef6-954d-53565900f381","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"189017a1-6573-4ddc-8e85-42292793cfe0":{"role":"reader","value":{"id":"189017a1-6573-4ddc-8e85-42292793cfe0","version":1,"type":"text","properties":{"title":[["go：\u0026^ 运算符 - 知乎 (zhihu.com)",[["a","https://zhuanlan.zhihu.com/p/86765504"]]]]},"format":{"copied_from_pointer":{"id":"4df9adce-ffed-414b-b3bb-d3b517f05d1b","table":"block","spaceId":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}},"created_time":1671179449318,"last_edited_time":1671179449318,"parent_id":"ed276d45-3e91-40f4-b3f7-559061948489","parent_table":"block","alive":true,"copied_from":"4df9adce-ffed-414b-b3bb-d3b517f05d1b","created_by_table":"notion_user","created_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","last_edited_by_table":"notion_user","last_edited_by_id":"83b4963a-e71e-4bac-9a62-dabfcb042aec","space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}}},"collection":{"a3ce75fe-7085-406b-a33f-74958ef7ee13":{"role":"reader","value":{"id":"a3ce75fe-7085-406b-a33f-74958ef7ee13","version":20,"name":[["NOBELIUM Template"]],"schema":{"NX\\Q":{"name":"date","type":"date"},"`gQ~":{"name":"type","type":"select","options":[{"id":"5aff2f95-fd1e-489b-8840-bf10bc9519cb","color":"purple","value":"Post"},{"id":"374d2bc6-a144-4832-8ca4-474aaae0ea1f","color":"orange","value":"Page"}]},"d]hq":{"name":"slug","type":"text"},"sD^m":{"name":"tags","type":"multi_select","options":[{"id":"149b2bfe-eff9-4a8e-a509-740376958f01","color":"orange","value":"计算机网络"},{"id":"fbfb28ff-2898-4f5b-a8e9-f18499a0f3da","color":"default","value":"Go"},{"id":"a7a581b6-5d07-466e-b0c8-69b6752bf06e","color":"gray","value":"数据库"},{"id":"7352dc92-14af-4c61-a6e4-1abfed244c4c","color":"purple","value":"算法"}]},"wz|S":{"name":"summary","type":"text"},"title":{"name":"title","type":"title"},"f211bdc0-ee00-4186-9a7d-f68c055ec2ee":{"name":"status","type":"select","options":[{"id":"22460321-fea2-4c7c-b352-a674760780ac","color":"orange","value":"Idea"},{"id":"41d5f5c6-b53c-42bc-8e0f-fc9402048480","color":"yellow","value":"Draft"},{"id":"c7390b31-9fab-4e21-94ee-7e67ea077a97","color":"blue","value":"Revise"},{"id":"7abc61d4-b405-480d-b699-12588755fa65","color":"red","value":"Published"}]}},"icon":"🎟️","format":{"copied_from_pointer":{"id":"dbf0f671-8075-49b9-b238-61e7eb9a7270","table":"collection","spaceId":"ac4cb96d-c8f8-4040-9bb2-868d9fc7f526"},"collection_page_properties":[{"visible":false,"property":"NX\\Q"},{"visible":false,"property":"d]hq"},{"visible":false,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"visible":false,"property":"sD^m"},{"visible":false,"property":"wz|S"},{"visible":false,"property":"`gQ~"}]},"parent_id":"1d21f050-c8c4-41f3-9fd4-8ff7de49c962","parent_table":"block","alive":true,"file_ids":["6cf3dc36-2f98-4f0e-9679-1bdbb1485129","5520bd92-e709-4c0d-ad58-06923f23f7e9","624d393a-62e3-4464-a1bf-1c79ecd4fbda","d52f6766-3e32-4c3d-8529-46e1f214360f"],"copied_from":"dbf0f671-8075-49b9-b238-61e7eb9a7270","migrated":true,"space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}}},"space":{},"collection_view":{"876cf270-3f6b-4f1a-b6c8-5ffbd27ca40f":{"role":"reader","value":{"id":"876cf270-3f6b-4f1a-b6c8-5ffbd27ca40f","version":26,"type":"table","name":"Default view","format":{"table_wrap":false,"table_properties":[{"width":416,"visible":true,"property":"title"},{"width":186,"visible":true,"property":"d]hq"},{"width":211,"visible":true,"property":"NX\\Q"},{"width":147,"visible":true,"property":"wz|S"},{"width":222,"visible":true,"property":"sD^m"},{"width":124,"visible":true,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"width":100,"visible":true,"property":"`gQ~"},{"width":200,"visible":true,"property":"gY~W"},{"width":200,"visible":true,"property":"pzWp"},{"visible":true,"property":"B;[p"}]},"parent_id":"1d21f050-c8c4-41f3-9fd4-8ff7de49c962","parent_table":"block","alive":true,"page_sort":["b1e1d645-db95-42e5-8995-39a80eda6460","e8cd3732-dc1c-43ae-959a-a5a611ec098a","e876558d-e878-47f6-8c95-21be678990a5","5a971ded-d3c5-41be-bef9-ddfff48d43a2","8db8b240-e1c5-4dd7-bf74-72584d7a2ce0","daf94ca4-ec56-47a3-84ed-b1e2479acc4b","d1a2db9b-6820-421e-9b80-017ce7478587","67ea9f83-b9f6-416b-afcb-7c64f7533e6c","45939470-9819-47e8-b12b-999cfefa0aad","c60dc33d-8efb-44be-a863-7a87ad047932","fe4b8d5f-7c49-42c6-a7d5-1cb71c4f7e86","b7233a67-c367-4198-831e-f12089568d1f","4f3bf306-92c4-41b7-a43e-957129a1240a","6a789607-66cf-498e-9b32-eb3fa69a84f4","c9429034-dabd-4a25-8782-97f20c808a60","38c49fe2-37f8-4a7f-a99f-9edb9ddad4c2","474eb638-9f6b-46bf-8004-77668293f199","81d6dfab-69cb-43a0-aa04-e9725f0b67e1","7703d956-84db-46cd-b538-48eae1af68b5","9f937c73-dac9-4ed7-9b01-beefcb321f16","3cf9dcb9-e7db-406c-80ab-c65c11fbf906","5827ab53-e051-455b-b90a-3bdc20158c2c","fa7acd3b-dea9-4fb1-b859-5345f35163c6","696dfc48-62c3-494d-96d0-ec5fa84637e8","79df93cf-9b10-452e-bc62-f39e8cd2d124","9bb8e52d-c459-4528-b1b3-c2378207253a","5da038ef-f419-4a11-aa48-587b3787e040","b4a2c9d4-6a2c-49e6-988d-89a538dfe0f6","c374a479-5cc7-4c54-ba69-6a4d76dc25ad","d470fa67-0e7c-40d8-86ac-9b5a8be88dc8","986be38b-9780-4bb9-bdcd-4e361ddbd888","b7613f56-c2d4-4aae-b967-b7471ade86d0","e357d1fc-7466-4d6a-8d48-71b76ea97cdc","e1735855-4089-4af6-bd4d-0d59f7a76cb4","9b34581a-955a-4229-99d0-8f2a6d0e69ce","b4414811-0599-45cf-b047-fa95eac42d89","c28a8a01-911a-40a2-a607-d3af8cb24017","461d07ae-4b4a-49de-bdcb-341af1153201","3df59023-cb68-4a65-afd1-7f0b8c21cb57","0e3223d1-03df-40fb-90f9-cc8559d776b5","4f45b7d6-cd5b-46ab-b2a6-37ae20bf5f21","fa475a21-5f38-43d4-9a89-67c40b3129ae","97cbc634-fe3a-4b9b-9da6-ac4aaa94772f","8a0d34bc-7e8c-4a68-88a5-5276274f612a","623f8788-a20f-45fd-bb82-08935f59b44d","7ee398f0-450b-47cb-9b53-f5e7736590d2","eae9f077-591e-4841-903b-db395513c834","367d0f2a-0b10-4dbb-b53a-613152f124f9","398e2e28-3997-49bc-a138-0467d4da8531","8aaf4633-e879-44dc-82c8-3c9fb9d3a6f8","1eb5e5f2-8dc9-4ffc-b5e1-09b67be27a83","83465fb9-205b-41fc-83a6-424692ee0a0e","fb1d18d0-6403-4e8a-840e-134553748ff5","4407cb77-3838-4ba5-b474-f15222cd3dba","1880b0f2-e036-42d0-9550-0fb08a962397","d8d60bd6-33f6-458f-a7d6-209ef2fb05a1","29bf65ff-888b-4a76-a8dd-bf54f02c3864","bad1d4ae-fd4a-4671-ae94-dd53d94e0eae","0d59792d-db1c-4ae7-8d7c-4f013be40dcf","337dc259-2805-4b1c-a60f-1b3e6c7badb8","4b1b21a8-c278-4bc6-88f1-1a35d407f4d7","7946aba2-d6d0-45ef-8779-23fa15db8f2d","c18dbce6-9e8c-4f4b-b74a-0994e7c1bc3f","84aa87b7-39e7-493c-87b9-5cae4de95449","1446eadb-8c01-4295-be3a-ecf19361c143","fe8a7d94-e9ba-457d-8f19-10fe53e6ca3c","98a5a0b6-b07b-4065-a73f-2949ad28ac47","38e3e030-5423-4343-b944-083b96fd8656","7dc3700b-1183-4e44-b4bb-cb500ae0b363","975051d4-ebbc-4b3f-98cf-1a52e5e4761d","e5d98bee-b2d5-4b45-ab0b-b77da24aebe7","acac2668-1062-4e7a-b095-eda067da8413","179025c4-d8a8-4c47-b621-9fd6a6f3339b","d256e5ed-5eac-43bb-a32e-581774962c23","3531b347-b0c9-406a-97ec-dc1233b52619","3760aeb0-084a-4e6d-88da-54a3c0311402","9c40a253-b9e8-42cd-8a99-62aaa9789a5e","f3c75b97-fd39-40bc-9473-2beb74d837b1","4d9edb9d-6ecd-4f3c-b41a-395987d6a714","c00f43c1-0fd5-45ca-a8af-e65a0bd6c990","9179759d-2b61-41a8-964e-23719e022b2d","19ad7e3a-2736-4d60-9516-6fcda35ed534","fe12b6af-37a2-4eab-a32f-5379fe881886","3634923c-2faf-4a31-a356-6ce9830706fb","6d9c82b0-2b20-425f-a87b-c9b14752bf9d","b57ebe77-5397-4ae8-b342-d19e3554f49c","1009ed18-593a-4ae7-8b32-7c39733138b5","d1d27099-40f0-4c1d-9c3b-a62349291ed2","f3ac9402-f3e4-4dc6-ae57-03d81bfd4e03","c1a9215b-4b3e-4d97-be31-f5d28736a065","8c80a9e1-a9d5-4b96-9a84-26df209c9537","ed91e3f2-5735-4c46-97db-aec5e6c4f597","7364073f-b7c8-436c-a471-779c7775fbf8","0f0ad844-b657-47c1-a04a-61d01ed706c1","6e55a5aa-680a-439d-add1-56498538aa64","7367ec26-da0a-441e-81b4-ae21068b94cf","48636b1e-62eb-449d-80db-68ee12d3caa8","f1c7db1e-871a-4529-9ba8-cd04f43979da","49477ffa-3ecf-49a3-a12d-62bea76192fc","1e50a8aa-3628-4b23-bd39-af65962e7061","fd0f48e9-d102-4502-9d06-94f78405f07a","51e53e64-e6dd-4fd6-8062-5d4455f0a1cb","f4ec684b-e5f1-44e9-a8a7-aca27f7ca6f3","177fa228-9099-4dd5-8969-c67f9c78bd0c","d5ab0d7a-0123-473f-84d4-81740defb9b4","548f6d36-c509-4b79-9c4b-59f227c7f550","c0901673-4f5e-4e51-ad87-0217f2d33a0c","0787f8d6-dc99-47c6-946e-2b008814bebc","0ade5216-1103-486a-aff0-a709ff825b02","a2c4dd21-985c-497d-b421-c2d8a9ec0eeb","908a498c-f7e3-4668-8afd-f179a027b4d9","4945e5c3-033d-467c-a8b3-b1479c1fdf0a","854f4584-28d5-43bd-938e-88d0957c78e3","6a6574f8-d63d-4fed-99c5-38f3df0364ac","baa9bf33-a11f-4da5-80eb-7930448aaad1","586d7983-2a0e-47ee-b80c-2800696255da","cf1ae05a-dc05-49ed-934b-adf97088cd5c","8cec23d1-4808-4ca8-9562-c98a44fa659c","918008b0-231b-4552-b752-e1f3dc35cbfc","24f98f49-407b-4f0c-b90b-7cb436c0063d","5625b2fb-6c82-4130-b336-0ec9a19d28ef","be5d776a-0cae-4ad0-b823-fc7c1371aca9","951d4753-cc76-4e10-9427-bc1517d34a8c","e7f7db5d-3e80-4afb-a4a8-4863c5302031","14b6937e-c536-48c7-95f8-b71b569ebc4d","ed276d45-3e91-40f4-b3f7-559061948489","0001a0d6-5549-4fc5-955f-57c356d6e87e","31a25d19-9261-43ad-b43e-a31d39f64545","7f5ff12b-b543-473c-9e05-bfba5d7dabff","69fd45e6-5797-4294-8c16-f0ba0a91ad5c","01ffb8be-f877-42b4-ba13-92ad393a7e6c","060867a6-c2c6-4a7c-a282-403e4081d6e4","e8704a7f-e816-4458-ae8a-0f9bc9f144b5","bbb78d74-fe80-4da0-9585-a2ef20ab4d1a","e6582267-a054-41b3-80ab-fb860956d3c5","91edf54b-8f96-4f4f-a127-f0b6435a56eb","a2a7b7e4-7286-4510-8576-cc45b70de00a"],"query2":{"filter":{"operator":"and"},"aggregations":[{"property":"title","aggregator":"count"}]},"space_id":"e7bb21a8-53c5-4141-a2a6-9c3a436ecfe4"}}},"notion_user":{},"collection_query":{},"signed_urls":{"0ba992f7-6fff-4750-a224-825dced20631":"https://s3.us-west-2.amazonaws.com/secure.notion-static.com/c570d58b-7992-4cca-b1c1-ad9aea894226/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230129%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230129T100549Z\u0026X-Amz-Expires=86400\u0026X-Amz-Signature=bb3d6fe020cb412e61111293b3adf874d8732c723e053f7fcda80a18fbb1d053\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject","87cb9adb-e52b-4a25-8daa-75edb8b69b64":"https://s3.us-west-2.amazonaws.com/secure.notion-static.com/b8eced42-e046-4d89-894b-f3331bc1b6e5/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230129%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230129T100549Z\u0026X-Amz-Expires=86400\u0026X-Amz-Signature=78c15380a4311effab419d6e370db45ce6f563d1a39acea59500e468a3fcf53f\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject","1d6ec7d1-7d9a-4e97-bf68-fa41b4982844":"https://s3.us-west-2.amazonaws.com/secure.notion-static.com/07b1c3a3-a71d-49ab-af2d-f7b440c6c984/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230129%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230129T100549Z\u0026X-Amz-Expires=86400\u0026X-Amz-Signature=06f6e055f83fbd6ab564e5080d01d64fb0d6e985ceb85eeae8e5d863ee536e6e\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject"}},"emailHash":"c8089598dc27a7944c95a8ed30867b78"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"slice"},"buildId":"3bOJ__T0UyKqwK2TxNz68","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>